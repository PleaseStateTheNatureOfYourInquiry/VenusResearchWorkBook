<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workbook &mdash; Venus Research Workbook 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=2709fde1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="VeRaTools" href="veratools.html" />
    <link rel="prev" title="Venus Research Workbook at ReadTheDocs" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Venus Research Workbook
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Workbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#temperature-vs-uv-brightness">Temperature vs UV-brightness</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vex-vera-data">VEX-VeRa data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#step-01-extract-vera-profiles-information">Step 01 - Extract VeRa-profiles information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-02-filter-vera-profiles">Step 02 - Filter VeRa profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-02bis-the-profiles-files">Step 02bis - the .profiles files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vex-vmc-data">VEX-VMC data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#reading-pds3-images-with-python">Reading PDS3 images with Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calibration-of-vmc-images">Calibration of VMC images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-01-select-process-vmc-images">Step 01 - Select &amp; process VMC images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-02-determine-phase-curve">Step 02 - Determine phase curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-03-investigate-correlation">Step 03 - Investigate correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-03bis-cloud-top-altitudes-as-a-function-of-latitude">Step 03bis - Cloud top altitudes as a function of latitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-04-thermal-tide-correction">Step 04 - Thermal tide correction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-05-first-correlation-analysis">Step 05 - First correlation analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-06-final-correlation-analysis">Step 06 - Final correlation analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#results-and-interpretation">Results and interpretation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#radiance-factor-ratio-vs-static-stability">Radiance Factor Ratio vs static stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#radiance-factor-ratio-vs-temperature">Radiance Factor Ratio vs temperature</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#appendix-longitude-and-local-solar-time-on-venus">Appendix: Longitude and Local Solar Time on Venus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="veratools.html">VeRaTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmctools.html">VMCTools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Venus Research Workbook</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Workbook</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/workbook.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="workbook">
<h1>Workbook<a class="headerlink" href="#workbook" title="Link to this heading"></a></h1>
<p>Go to <a class="reference internal" href="#lastpointofwork"><span class="std std-ref">last point of work</span></a>.</p>
<a class="reference internal image-reference" href="_images/construction.png"><img alt="_images/construction.png" src="_images/construction.png" style="width: 80.0px; height: 80.0px;" /></a>
<div class="admonition-abbreviations admonition" id="abbrevations">
<p class="admonition-title">abbreviations</p>
<div class="line-block">
<div class="line"><strong>IDL</strong> - Interactive Data Language</div>
<div class="line"><strong>LST</strong> - Local Solar Time</div>
<div class="line"><strong>SPDC</strong> - South Polar Dynamics Campaign</div>
<div class="line"><strong>VeRa</strong> - VEnus RAdio science</div>
<div class="line"><strong>VEX</strong> - Venus Express</div>
<div class="line"><strong>VMC</strong> - Venus Monitoring Camera</div>
</div>
</div>
<div class="admonition-vex-orbit-ids admonition">
<p class="admonition-title">VEX Orbit IDs</p>
<p>The information about the orbit IDs per mission section comes from the file
<code class="file docutils literal notranslate"><span class="pre">SOMEWHEREONYOURCOMPUTER/Data/VEX/VEX-SCIOPS-LI-053_1_1_VEX_Orbit_Date_DOY_Listing_2014Sep15.numbers</span></code>,
see also the link to <a class="reference external" href="https://www.cosmos.esa.int/web/psa/venus-express">Venus Express at the ESA PSA</a>.</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text"><strong>VEX Orbit IDs</strong></span><a class="headerlink" href="#id5" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>mission section</p></th>
<th class="head"><p>orbit ID range</p></th>
<th class="head"><p>date range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Nominal mission</p></td>
<td><p>0001 - 0547</p></td>
<td><p>20-04-2006 - 20-10-2007</p></td>
</tr>
<tr class="row-odd"><td><p>Extension 1</p></td>
<td><p>0548 - 1135</p></td>
<td><p>21-10-2007 - 30-05-2009</p></td>
</tr>
<tr class="row-even"><td><p>Extension 2</p></td>
<td><p>1136 - 1583</p></td>
<td><p>31-05-2009 - 21-08-2010</p></td>
</tr>
<tr class="row-odd"><td><p>Extension 3</p></td>
<td><p>1584 - 2451</p></td>
<td><p>22-08-2010 - 05-01-2013</p></td>
</tr>
<tr class="row-even"><td><p>Extension 4</p></td>
<td><p>2452 - 3575</p></td>
<td><p>06-01-2013 - 31-12-2015</p></td>
</tr>
<tr class="row-odd"><td><p>SPDC</p></td>
<td><p>2775 - 2811</p></td>
<td><p>25-11-2013 - 31-12-2013</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition-unresolved-questions-not-to-forget admonition" id="unresolvedquestionnottoforget">
<p class="admonition-title">unresolved questions not to forget</p>
<ul class="simple">
<li><p><a class="reference internal" href="#unresolvedquestion1"><span class="std std-ref">Why during the some orbits, in the same orbit different calibration factors where used?</span></a></p></li>
</ul>
</div>
<div class="admonition-analysisconfiguration-py-file admonition" id="analysisconfigurationfile">
<p class="admonition-title">analysisConfiguration.py file</p>
<p>This file contains configuration settings needed for the scripts in this project to run.
It <em>should</em> be easy to migrate this entire project to another computer, just by substituting the paths and names of these directories in this file.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">VeRaDataDirectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/Data/VEX/VeRa&#39;</span>
<span class="n">VMCDataDictectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/Data/VEX/VMC&#39;</span>
<span class="n">AkatsukiDataDirectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/Data/Akatsuki&#39;</span>
<span class="n">SPICAVUCDataDirectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/Data/EmmanuelMarcq2020&#39;</span>

<span class="n">VeRaWorkBookDirectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/VenusResearchWorkBook/Temperature-UVBrightness-Project/VeRa&#39;</span>
<span class="n">VMCWorkBookDirectory</span> <span class="o">=</span> <span class="s1">&#39;/Users/maarten/Science/Venus/VenusResearchWorkBook/Temperature-UVBrightness-Project/VMC&#39;</span>

<span class="n">radiusOfVenus</span> <span class="o">=</span> <span class="mi">6052</span> <span class="c1">#km</span>
</pre></div>
</div>
<p>The content of this file is loaded at the top of a script using:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the path where the  analysisConfiguration.py  script file lives relative to where the script file lives and is run from.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span> <span class="p">(</span><span class="s1">&#39;../../../&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Import the content of the  analysisConfiguration.py  file.</span>
<span class="kn">from</span> <span class="nn">analysisConfiguration</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<section id="temperature-vs-uv-brightness">
<span id="temperaturevsuvbrightness"></span><h2>Temperature vs UV-brightness<a class="headerlink" href="#temperature-vs-uv-brightness" title="Link to this heading"></a></h2>
<p>The goal of this project is to investigate whether there is any relation between the atmospheric temperature as measured by means of radio occultation experiments and the UV-brightness as measured from images in the UV.</p>
<p>I started this project with Colin Wilson at Oxford in 2015. At the time, I wrote all scripts using Interactive Date Language (IDL).
At this point (2024) I redo the entire analysis, rewriting all code using Python, documenting the process and the code as thoroughly as possible.</p>
<p>We use Venus Express VeRa and VMC data.</p>
<section id="vex-vera-data">
<span id="vexveradata"></span><h3>VEX-VeRa data<a class="headerlink" href="#vex-vera-data" title="Link to this heading"></a></h3>
<p>Files are found in <code class="file docutils literal notranslate"><span class="pre">VeRa</span></code>.</p>
<section id="step-01-extract-vera-profiles-information">
<span id="verastep01"></span><h4>Step 01 - Extract VeRa-profiles information<a class="headerlink" href="#step-01-extract-vera-profiles-information" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VeRa/Step01</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateTable_VeRa_LocalSolarTime.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateFigure_VeRaProfiles_Lon-Lat_LST-Lat.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRa_LocalSolarTime_OneBarLevel_PerOrbit_SPoleProfiles.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRa_LocalSolarTime_OneBarLevel_PerOrbit_SelectedProfiles.dat</span></code></div>
</div>
</div>
<p>Using the <code class="file docutils literal notranslate"><span class="pre">VeRa_LocalSolarTime_CreateTable.py</span></code> script, I create two tables that list the <strong>orbit ID, Day Of Year, time of observation, Local Solar Time, latitude, longitude</strong> and <strong>solar zenith angle</strong> at the one bar level for each of the VeRa soundings used in this project.</p>
<p>The table <code class="file docutils literal notranslate"><span class="pre">VeRa_LocalSolarTime_OneBarLevel_PerOrbit_SPoleProfiles.dat</span></code> contains this information for all the selected profiles from the <strong>SPDC</strong> (orbits 2775 - 2811).
The table <code class="file docutils literal notranslate"><span class="pre">VeRa_LocalSolarTime_OneBarLevel_PerOrbit_SelectedProfiles.dat</span></code> contains this information for all the selected profiles from the mission before the <strong>SPDC</strong>. (first included orbit 0260, last included orbit 2638).</p>
<p>With the <code class="file docutils literal notranslate"><span class="pre">VeRaProfiles_Lon-Lat_LST-Lat_Figure.py</span></code> I create two plots, showing the distribution of the VeRa sounding locations on the Venus disk and as a function of  <em>LST</em>:</p>
<a class="reference internal image-reference" href="_images/VeRaProfiles_Lon-Lat_Figure.png"><img alt="_images/VeRaProfiles_Lon-Lat_Figure.png" src="_images/VeRaProfiles_Lon-Lat_Figure.png" style="width: 384.0px; height: 288.0px;" /></a>
<a class="reference internal image-reference" href="_images/VeRaProfiles_LocalSolarTime-Lat_Figure.png"><img alt="_images/VeRaProfiles_LocalSolarTime-Lat_Figure.png" src="_images/VeRaProfiles_LocalSolarTime-Lat_Figure.png" style="width: 384.0px; height: 288.0px;" /></a>
</section>
<section id="step-02-filter-vera-profiles">
<span id="verastep02"></span><h4>Step 02 - Filter VeRa profiles<a class="headerlink" href="#step-02-filter-vera-profiles" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VeRa/Step02</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateFigure_VeRaAverageProfile_Tz_dTdz.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateNumpyArray_VeRaAverageProfiles.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRaSelectedProfiles.profiles</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRaSouthPolarDynamicsCampaignProfiles.profiles</span></code></div>
</div>
</div>
<p>We believe that a vertical resolution of 1km for the temperature profiles is sufficient for our purposes.
Depending of the altitude of sounding, the VeRa profiles have a (much) higher vertical resolution.
I create vertically <strong>averaged</strong> profiles, where I average the temperatures values in vertical bins of one kilometer wide.
I take the standard deviation in each bin as the uncertainty of the average temperature for that bin.
If there is only one value in the bin, then the uncertainty is not calculated (set to NaN). This occurs higher in the atmosphere, above 80km altitude, a region that is not important for this study.</p>
<p>The <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#VeRaTools.VeRaTools.getFilteredVeRaProfile">VeRaTools.getFilteredVeRaProfile</a> method of the <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#">VeraTools pseudo class</a> is designed to create a filtered (vertically averaged) profile from an original VeRa profile.
I use the default settings to calculate profiles between 46km and 101km (56 levels) at a 1km vertical resolution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Radius of Venus = 6051.8km, we adopt 6052km, hence 6098km ~ 46km altitude.</p>
</div>
<p>As an example plots of T(z), dT/dZ (z) and the static stability are shown below with the results for the last VeRa profile from the South Polar Dynamics Campaign (<code class="file docutils literal notranslate"><span class="pre">./scripts/VeRaAverageProfile_Tz_dTdz_Figure.py</span></code>, also see <a class="reference internal" href="#verastep02bis"><span class="std std-ref">Step02bis</span></a> for details on the <code class="code docutils literal notranslate"><span class="pre">.profiles</span></code> files):</p>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="_images/VeRaProfiles_Orb2811_T-z_Figure.png"><img alt="_images/VeRaProfiles_Orb2811_T-z_Figure.png" src="_images/VeRaProfiles_Orb2811_T-z_Figure.png" style="width: 1200.0px; height: 360.0px;" /></a>
<figcaption>
<p><span class="caption-text">(left) Averaged temperature profile between 50 and 100km altitude (blue) and original VeRa profile (orange); (middle) uncertainty (standard deviation) in the temperature as explained in the text above. The gaps are due to missing point, when the uncertainty is set to NaN, because there is only one temperature value in a vertical bin; (right) number of original VeRa temperatures for each vertical bin, in red are indicated levels with only one temperature value.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id7">
<a class="reference internal image-reference" href="_images/VeRaProfiles_Orb2811_dTdz-z_Figure.png"><img alt="_images/VeRaProfiles_Orb2811_dTdz-z_Figure.png" src="_images/VeRaProfiles_Orb2811_dTdz-z_Figure.png" style="width: 900.0px; height: 360.0px;" /></a>
<figcaption>
<p><span class="caption-text">(left) Averaged temperature profile dT/dz between 50 and 100km altitude (blue); (middle) parametrised adiabatic lapse rate from Figure 18 in <a class="reference internal" href="#seiff1980"><span class="std std-ref">Seiff et al. (1980)</span></a>; (right) static stability = lapse rate + adiabatic lapse rate.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="step-02bis-the-profiles-files">
<span id="verastep02bis"></span><h4>Step 02bis - the .profiles files<a class="headerlink" href="#step-02bis-the-profiles-files" title="Link to this heading"></a></h4>
<p>In order to make it easier to access all the filtered profiles at once, without the need to recalculate each one of them,
I create and run the <code class="file docutils literal notranslate"><span class="pre">./scripts/VeRaAverageProfiles_CreateNumpyArray.py</span></code> script to load the desired original VeRa profiles, filter them and store the results in a Python dictionary variable.  I create two NumPy files (using the <code class="code docutils literal notranslate"><span class="pre">np.save</span></code> function):</p>
<div class="line-block">
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRaSelectedProfiles.profiles</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VeRaSouthPolarDynamicsCampaignProfiles.profiles.profiles</span></code></div>
</div>
<p>Each file is a Python dictionary with the following structure:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s1">&#39;OrbitID&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;ProfileID&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;LatitudeOneBar&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;LongitudeOneBar&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;DayOfYear&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;TimeOfDay&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;LocalSolarTime&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;FilteredProfiles&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;NumberOfFilteredLevels&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;OriginalProfiles&#39;</span> <span class="p">:</span> <span class="p">[],</span>
  <span class="s1">&#39;NumberOfOriginalLevels&#39;</span> <span class="p">:</span> <span class="p">[]</span> <span class="p">}</span>
</pre></div>
</div>
<p>Each key in the dictionary corresponds to a list of the variables as indicated by the key.
The length of each list for each key is the same and all elements at the same index in the lists correspond to each other.
They can be read with the following command:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">profilesDictionary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span> <span class="p">(</span><span class="s1">&#39;VeRaSouthPolarDynamicsCampaignProfiles.profiles&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span> <span class="p">()</span>
</pre></div>
</div>
<p>As an example the last profiles in the <code class="file docutils literal notranslate"><span class="pre">VeRaSouthPolarDynamicsCampaignProfiles.profiles.profiles</span></code> file, corresponding to the figures in <a class="reference internal" href="#verastep02"><span class="std std-ref">VeRaStep02</span></a>:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['OrbitID'][-1]:</span> <span class="pre">'2811'</span> <span class="pre">#</span> <span class="pre">str</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['ProfileID'][-1]:</span> <span class="pre">'V32ICL2L04_AEX_133650732_60.TAB'</span> <span class="pre">#</span> <span class="pre">str</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['LatitudeOneBar'][-1]:</span> <span class="pre">-55.5</span> <span class="pre">#</span> <span class="pre">float;</span> <span class="pre">unit</span> <span class="pre">˚`</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['LongitudeOneBar'][-1]:</span> <span class="pre">63.14</span> <span class="pre">#</span> <span class="pre">float;</span> <span class="pre">unit</span> <span class="pre">˚`</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['DayOfYear'][-1]:</span> <span class="pre">'2013-12-31</span> <span class="pre">#</span> <span class="pre">str</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['TimeOfDay'][-1]:</span> <span class="pre">7.955436944444445</span> <span class="pre">#</span> <span class="pre">float;</span> <span class="pre">unit</span> <span class="pre">hours</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['LocalSolarTime'][-1]:</span> <span class="pre">16.07</span> <span class="pre">#</span> <span class="pre">float;</span> <span class="pre">unit</span> <span class="pre">hours</span></code></div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['FilteredProfiles'][-1]:</span> <span class="pre">#</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">10</span> <span class="pre">lists</span></code> (first element of return of <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#VeRaTools.VeRaTools.getFilteredVeRaProfile">VeRaTools.getFilteredVeRaProfile</a>)</div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['NumberOfFilteredLevels'][-1]:</span> <span class="pre">56</span> <span class="pre">#</span> <span class="pre">int</span></code> (second element of return of <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#VeRaTools.VeRaTools.getFilteredVeRaProfile">VeRaTools.getFilteredVeRaProfile</a>)</div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['OriginalProfiles'][-1]:</span> <span class="pre">#</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">seven</span> <span class="pre">lists</span></code> (first element of return of <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#VeRaTools.VeRaTools.readVeRaTAB">VeRaTools.readVeRaTAB</a>)</div>
<div class="line"><code class="code docutils literal notranslate"><span class="pre">profilesDictionary</span> <span class="pre">['NumberOfOriginalLevels'][-1]:</span> <span class="pre">643</span> <span class="pre">#</span> <span class="pre">int</span></code> (second element of return of <a class="reference external" href="https://venustools.readthedocs.io/en/latest/veratools.html#VeRaTools.VeRaTools.readVeRaTAB">VeRaTools.readVeRaTAB</a>)</div>
</div>
</div></blockquote>
</section>
</section>
<section id="vex-vmc-data">
<span id="vexvmcdata"></span><h3>VEX-VMC data<a class="headerlink" href="#vex-vmc-data" title="Link to this heading"></a></h3>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/workingWithPlanetaryImages.py</span></code></div>
<div class="line">files:</div>
</div>
</div>
<section id="reading-pds3-images-with-python">
<span id="readingvmcimagespython"></span><h4>Reading PDS3 images with Python<a class="headerlink" href="#reading-pds3-images-with-python" title="Link to this heading"></a></h4>
<p>The VMC PDS files are stored in <strong>PDS3</strong> format.
A search for a Python module to read these files leads to <a class="reference external" href="https://planetaryimage.readthedocs.io/en/latest/index.html">planetaryimage</a>.
It is older software, I see that the latest update recorded on the website is from 26 March 2016 (20160326), but for my purposes it is exactly what I need.
After all, the PDS files are from that same time period. I install the module with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install planetaryimage</span>
</pre></div>
</div>
<p>I also retrieve the source code from Github and park it in <code class="file docutils literal notranslate"><span class="pre">VMC/planetaryimage-master</span></code>, and compile the <a class="reference external" href="file:../Temperature-UVBrightness-Project/VMC/planetaryimage-master/docs-html/index.html">documentation locally</a>.
I try it out with the Python script <code class="file docutils literal notranslate"><span class="pre">./scripts/workingWithPlanetaryImages.py</span></code>:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">planetaryimage</span> <span class="kn">import</span> <span class="n">PDS3Image</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">VMCimage</span> <span class="o">=</span> <span class="n">PDS3Image</span><span class="o">.</span><span class="n">open</span> <span class="p">(</span><span class="s1">&#39;/Users/maarten/Science/Venus/Data/VEX/VMC/Orb0085/V0085_0000_UV2.IMG&#39;</span><span class="p">)</span>
<span class="n">VMCimageGEO</span> <span class="o">=</span> <span class="n">PDS3Image</span><span class="o">.</span><span class="n">open</span> <span class="p">(</span><span class="s1">&#39;/Users/maarten/Science/Venus/Data/VEX/VMC/Orb0085/V0085_0000_UV2.GEO&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span> <span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;.../Temperature-UVBrightness-Project/VMC/Orb0085/V0085_0000_UV2.IMG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="n">VMCimage</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span> <span class="p">(</span><span class="s1">&#39;V0085_0000_UV2.png&#39;</span><span class="p">)</span>

<span class="c1"># datetime object</span>
<span class="nb">print</span> <span class="p">(</span> <span class="s2">&quot;VMCimageGEO.label [&#39;START_TIME&#39;]&quot;</span><span class="p">,</span> <span class="n">VMCimageGEO</span><span class="o">.</span><span class="n">label</span> <span class="p">[</span><span class="s1">&#39;START_TIME&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span> <span class="s1">&#39;day = </span><span class="si">{}</span><span class="s1">, hour = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span> <span class="p">(</span><span class="n">VMCimageGEO</span><span class="o">.</span><span class="n">label</span> <span class="p">[</span><span class="s1">&#39;START_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">VMCimageGEO</span><span class="o">.</span><span class="n">label</span> <span class="p">[</span><span class="s1">&#39;START_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hour</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span> <span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;latitude plane index [3]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span> <span class="p">(</span><span class="n">VMCimageGEO</span><span class="o">.</span><span class="n">data</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span> <span class="p">(</span><span class="s1">&#39;V0085_0000_UV2_latitude.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Execution leads to:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">run</span> <span class="n">workingWithPlanetaryImages</span><span class="o">.</span><span class="n">py</span>
<span class="n">VMCimageGEO</span><span class="o">.</span><span class="n">label</span> <span class="p">[</span><span class="s1">&#39;START_TIME&#39;</span><span class="p">]</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">14</span> <span class="mi">16</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">31</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">day</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">hour</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/V0260_0008_UV2.png"><img alt="_images/V0260_0008_UV2.png" src="_images/V0260_0008_UV2.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/V0260_0008_UV2_latitude.png"><img alt="_images/V0260_0008_UV2_latitude.png" src="_images/V0260_0008_UV2_latitude.png" style="width: 448.0px; height: 336.0px;" /></a>
</section>
<section id="calibration-of-vmc-images">
<span id="calibratingvmcimages"></span><h4>Calibration of VMC images<a class="headerlink" href="#calibration-of-vmc-images" title="Link to this heading"></a></h4>
<p>The calibrated radiance factor <span class="math notranslate nohighlight">\(RF_{x,y}\)</span> for a valid (= on Venus disk) pixel <span class="math notranslate nohighlight">\((x,y)\)</span> in a VMC image is:</p>
<div class="math notranslate nohighlight">
\[RF_{x,y} = \pi \beta R_{observed - x,y} \frac {d_{Venus}}{S_{Sun}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the calibration correction factor (see <a class="reference internal" href="#shalygina2015"><span class="std std-ref">Shalygina  et al. 2015</span></a>, their Table 1), <span class="math notranslate nohighlight">\(R_{observed - x,y}\)</span> is the value at the pixel in ADU times the radiance scaling factor read from the VMC image header (<code class="code docutils literal notranslate"><span class="pre">VMCImage.label</span> <span class="pre">['RADIANCE_SCALING_FACTOR'].value</span></code>, when read with <a class="reference external" href="https://planetaryimage.readthedocs.io/en/latest/index.html">planetaryimage module</a> in Python) in <span class="math notranslate nohighlight">\(W/m^2/\mu m/ster/ADU\)</span>, <span class="math notranslate nohighlight">\(d_{Venus}\)</span> is the distance of Venus to the Sun in AU and <span class="math notranslate nohighlight">\(S_{Sun}\)</span> the solar flux in <span class="math notranslate nohighlight">\(W/m^2/\mu m\)</span> at 1AU (see <a class="reference internal" href="#lee2015a"><span class="std std-ref">Lee et al. 2015</span></a> their Equation 2).</p>
<p>For <span class="math notranslate nohighlight">\(S_{Sun}\)</span> (from <a class="reference internal" href="#lee2015a"><span class="std std-ref">Lee et al. 2015</span></a> their Equation 1):</p>
<div class="math notranslate nohighlight">
\[S_{Sun} = \frac {\int S_{irradiance}(\lambda) T(\lambda) d\lambda}{\int T (\lambda) d\lambda}\]</div>
<p>I determined the <span class="math notranslate nohighlight">\(S_{irradiance}\)</span> using the <a class="reference external" href="https://www.nrel.gov/grid/solar-resource/spectra.html">Solar Spectra website</a> and the transmission function of the UV filter of the VMC camera (<a class="reference internal" href="#markiewicz2007"><span class="std std-ref">Markiewicz et al. 2007</span></a> their Figure 3):</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Markiewicz_2007_Figure3.png"><img alt="_images/Markiewicz_2007_Figure3.png" src="_images/Markiewicz_2007_Figure3.png" style="width: 974.0px; height: 496.0px;" /></a>
</figure>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="_images/Markiewicz_2007_Figure3_UV.jpg"><img alt="_images/Markiewicz_2007_Figure3_UV.jpg" src="_images/Markiewicz_2007_Figure3_UV.jpg" style="width: 262.5px; height: 396.8px;" /></a>
<figcaption>
<p><span class="caption-text">My parametrisation of the UV part of Figure 3 from <a class="reference internal" href="#markiewicz2007"><span class="std std-ref">Markiewicz et al. 2007</span></a></span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This results is <span class="math notranslate nohighlight">\(S_{Sun} = 1081 W/m^2/\mu m\)</span>.</p>
<p>The value of <span class="math notranslate nohighlight">\(d_{Venus} = 0.723AU\)</span> to within 1% in <span class="math notranslate nohighlight">\(d_{Venus}^2\)</span> over the orbit of Venus. I therefore consider this value a contant.</p>
</section>
<section id="step-01-select-process-vmc-images">
<span id="vmcstep01"></span><h4>Step 01 - Select &amp; process VMC images<a class="headerlink" href="#step-01-select-process-vmc-images" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step01</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/VMCImagesEvaluate.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages_orbits_later_than_1188.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.iValidPoints</span></code></div>
</div>
</div>
<p>I have carefully looked at the process I developed and followed in 2015 using IDL-scripts.
Here I redo everything with Python.</p>
<p>The first step is to select all the VMC images that are useful for the analysis.
The criterium is that at the time the VMC image was taken, the wind advected area where the VeRa sounding was acquired on the same orbit is on the visible part of the Venus disk, <em>i.e.</em> I take pixels with a solar incidence angle &lt; 89˚.
The correction for wind advection is calculated by taking the average wind speed at the latitude of the VeRa sounding (at 70km altitude) times the time span between the VMC and the VeRa observation. Both zonal and meridional winds are taken into account. For this I parametrise the winds profile:</p>
<div class="admonition-parametrisation-of-the-zonal-and-meridional-wind admonition">
<p class="admonition-title">Parametrisation of the zonal and meridional wind.</p>
<p><a class="reference internal" href="#khatuntsev2013"><span class="std std-ref">Khatuntsev et al. (2013)</span></a> report on the zonal and meridional wind profiles measured from VEX orbits up to 2299 (10-year period).
They present the result in their figures 10(a) and (b): <em>Mean zonal (a) and meridional (b) profiles of the wind speed derived over the period of 10 venusian years by manual cloud tracking. Error bars correspond to 99.9999% 5σ-x confidence interval based on the standard deviation of the weighted mean. Standard deviations are presented by shadowed areas.</em></p>
<p>They present the formulae (their Equations (1) and (2)) with which the winds have been calculated by comparing two images:</p>
<div class="math notranslate nohighlight">
\[U = \frac {(\lambda_2 - \lambda_1) (R+h) cos (\theta)}{\Delta t}\]</div>
<div class="math notranslate nohighlight">
\[V = \frac {(\theta_2 - \theta_1) (R + h)}{\Delta t}\]</div>
<p>where the indices <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span> refer to the first and second image, <span class="math notranslate nohighlight">\(\lambda\)</span> is the longitude and <span class="math notranslate nohighlight">\(\theta\)</span> the latitude. Since <span class="math notranslate nohighlight">\(U\)</span> is negative (see table below), it means the wind blows the clouds in the direction of smaller Venus longitudes.</p>
<p>From my (physical) notebook entry on 19-03-2015: the average zonal wind is determined from figure 10a in <a class="reference internal" href="#khatuntsev2013"><span class="std std-ref">Khatuntsev et al. (2013)</span></a>
and can be parametrised as (<span class="math notranslate nohighlight">\(U\)</span> in units of m/s):</p>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text"><strong>Parametrised average zonal wind</strong></span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Latitude range (˚)</p></th>
<th class="head"><p>wind parametrisation (m/s)</p></th>
<th class="head"><p>notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(-75˚, -50˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(U({\theta})\)</span> =  -94   + (<span class="math notranslate nohighlight">\({\theta}\)</span> + 50) * (65.6/-25)</p></td>
<td><p>also use for latitudes down to -90˚.</p></td>
</tr>
<tr class="row-odd"><td><p>(-50˚, -40˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(U({\theta})\)</span> = -101.5 + (<span class="math notranslate nohighlight">\({\theta}\)</span> + 40) * (7.5/-10)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>(-40˚, -15˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(U({\theta})\)</span> =  -93 + (<span class="math notranslate nohighlight">\({\theta}\)</span> + 15) * (-8.5/-35)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>(-15˚, 0˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(v{\theta})\)</span> = -93</p></td>
<td></td>
</tr>
</tbody>
</table>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="_images/Khatuntsev_2013_Figure10a_ZonalWind.jpg"><img alt="_images/Khatuntsev_2013_Figure10a_ZonalWind.jpg" src="_images/Khatuntsev_2013_Figure10a_ZonalWind.jpg" style="width: 160.60000000000002px; height: 123.80000000000001px;" /></a>
<figcaption>
<p><span class="caption-text">Khatuntsev et al. (2013) Figure 10a. Zonal wind parametrisation.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>From my (physical) notebook entry on 24-04-2015: the average meridional wind is determined from figure 10b in <a class="reference internal" href="#khatuntsev2013"><span class="std std-ref">Khatuntsev et al. (2013)</span></a>
and can be parametrised as (<span class="math notranslate nohighlight">\(V\)</span> in units of m/s):</p>
<table class="docutils align-default" id="id11">
<caption><span class="caption-text"><strong>Parametrised average meridional wind</strong></span><a class="headerlink" href="#id11" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Latitude range (˚)</p></th>
<th class="head"><p>wind parametrisation (m/s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(-90˚, -75˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(V({\theta})\)</span>) =  0</p></td>
</tr>
<tr class="row-odd"><td><p>(-75˚, -50˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(V({\theta})\)</span>) = -9.58 + ( <span class="math notranslate nohighlight">\({\theta}\)</span> + 50 ) * (9.38/-25)</p></td>
</tr>
<tr class="row-even"><td><p>(-50˚, -20˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(V({\theta})\)</span>) = -6.5  + ( <span class="math notranslate nohighlight">\({\theta}\)</span> + 20 ) * (-3.08/-30)</p></td>
</tr>
<tr class="row-odd"><td><p>(-20˚, 0˚]</p></td>
<td><p><span class="math notranslate nohighlight">\(V({\theta})\)</span>) = -3.26 + ( <span class="math notranslate nohighlight">\({\theta}\)</span> + 0 )   * (-3.24/-20)</p></td>
</tr>
</tbody>
</table>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="_images/Khatuntsev_2013_Figure10b_MeridionalWind.jpg"><img alt="_images/Khatuntsev_2013_Figure10b_MeridionalWind.jpg" src="_images/Khatuntsev_2013_Figure10b_MeridionalWind.jpg" style="width: 175.70000000000002px; height: 118.9px;" /></a>
<figcaption>
<p><span class="caption-text">Khatuntsev et al. (2013) Figure 10b. Meridional wind parametrisation.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<p>The latitude and longitude of the VeRa sounding, which is the starting location for the calculation of the corresponding area in the VMC images, is taken at the cloud top level at 70km altitude and is extracted from the average VeRa profiles as described in <a class="reference internal" href="#verastep02"><span class="std std-ref">Step 2</span></a> of the <a class="reference internal" href="#vexveradata"><span class="std std-ref">VEX-VeRa Data</span></a> section.</p>
<p>For the standard deviation of the wind speeds I estimate 20m/s for the zonal wind and 12m/s for the meridional winds, based on the gray areas of the figures 10a and 10b in <a class="reference internal" href="#khatuntsev2013"><span class="std std-ref">Khatuntsev et al. (2013)</span></a>.</p>
<figure class="align-default" id="id13">
<a class="reference internal image-reference" href="_images/Khatuntsev_2013_Figure10a-b.png"><img alt="_images/Khatuntsev_2013_Figure10a-b.png" src="_images/Khatuntsev_2013_Figure10a-b.png" style="width: 402.8px; height: 159.60000000000002px;" /></a>
<figcaption>
<p><span class="caption-text">Khatuntsev et al. (2013) Figure 10, the standard deviation is defined by the gray areas.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>These uncertainties determine the size of the area, the <em>latitude-longitude-box</em>, around the VeRa sounding location at the time of the VMC image observation: the corners of the box are calculated by taking the zonal and meridional wind speeds plus or minus their standard deviations, and calculate where the VeRa location would be advected to in those cases over the time difference between the VMC image and the VeRa acquisition. The larger the time span, the larger the uncertainty and thus the <em>latitude-longitude-box</em>.</p>
<p>I create the method <a class="reference external" href="https://venustools.readthedocs.io/en/latest/vmctools.html#VMCTools.VMCTools.getWindAdvectedBox">getWindAdvectedBox</a> in the <a class="reference external" href="https://venustools.readthedocs.io/en/latest/vmctools.html#">VMCTools pseudo class</a> to calculate this <em>latitude-longitude-box</em> for a given VMC image.
This method is called in the script <code class="file docutils literal notranslate"><span class="pre">./scripts/VMCImagesEvaluate.py</span></code>.</p>
<p>Running this scripts has two iterations. During the first iteration, I create to process all the images and create plots of each image with the position of the VeRa sounding indicated with a <strong>X</strong> and a box indicating the wind advected area of that location at the time of the VMC image in question.
These plots are saved in the subfolder <code class="file docutils literal notranslate"><span class="pre">Images</span></code> created inside the directories of the orbits containing the .GEO and .IMG files, for example <code class="file docutils literal notranslate"><span class="pre">SOMEPATH//Venus/Data/VEX/VMC/Orb2811/Images</span></code>.</p>
<p>I manually evaluate each image plot and select the ones that have the advected box fully on the visible disk of Venus as mentioned above, and copy these plots to the <code class="file docutils literal notranslate"><span class="pre">UsedImages</span></code> subfolder that I manually create in each orbit directory, for example
<code class="file docutils literal notranslate"><span class="pre">SOMEPATH/Venus/Data/VEX/VMC/Orb2811/UsedImages</span></code>.</p>
<p>I now run the <code class="file docutils literal notranslate"><span class="pre">./scripts/VMCImagesEvaluate.py</span></code> script a second time to process the selected images and write the results to the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> table file. The header and first few lines of which are of this file are shown below.</p>
<p>In the script I built the option to choose the minimal orbitID from where to start this process.
The file <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> has all valid orbits,
the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages_orbits_later_than_1188.dat</span></code> has valid starting at orbitID 1188, which is what is used for the final analysis as explained in further steps in this Workbook.</p>
<p>The header, the first few and the last few lines of this file are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> File: VMCSelectedImages_orbits_later_than_1188.dat
 Created at 2024-10-21 at 11:42:30

  Target altitude (cloud tops) = 70km (Lat_VeRa, Lon_VeRa, T, dT)
  Standard deviation zonal wind = 20m/s
  Standard deviation meridional wind = 12m/s

  # point in box are all the points in the latitude-longitude box on the Venus disk
  Radiance factor is the average of the points in the latitude-longitude box with values &gt; 0 and incidence angles &lt; 89˚
  dRadiance factor is the standard deviation of the radiance factor

 56 orbits with a total of 972 images


 Orbit       Image          DOY      VeRa Time    VMC Time   Time diff  Lat_VeRa   Lon_VeRa   lat_centre_VMC   Lat_range_VMC   Lon_centre_VMC   Lon_range_VMC      Phase Angle   #Points in box   Radiance factor  dRadiance factor     T       dT     Local Solar Time   Emission Angle   Incidence Angle

 56 orbits with a total of 972 images

                         yyyy-mm-dd     (h)         (h)         (h)       (˚)        (˚)            (˚)             (˚)              (˚)             (˚)               (˚)                                                             (K)      (K)          (h)                (˚)              (˚)
C_END
 1191   V1191_0040_UV2   2009-07-25     0.26       20.70       -3.56    -15.33     143.00         -14.64      -16.08  -13.20       154.57      152.09    157.06       93.94             35              0.491            0.029        229.62    2.264       13.70              45.76            65.32
 1191   V1191_0044_UV2   2009-07-25     0.26       21.20       -3.06    -15.33     143.00         -14.74      -15.97  -13.50       152.95      150.81    155.08       94.07             31              0.514            0.022        229.62    2.264       13.70              45.73            65.53
     ....
     ....
 2811   V2811_0084_UV2   2013-12-31     7.96        8.65        0.69    -58.03      62.02         -58.19      -58.47  -57.91        58.80       57.91     59.68       29.57              7              0.874            0.030        227.96    0.680       16.07              45.14            55.39
 2811   V2811_0088_UV2   2013-12-31     7.96        8.98        1.03    -58.03      62.02         -58.26      -58.68  -57.84        57.25       55.94     58.56       34.38             13              0.800            0.029        227.96    0.680       16.07              41.28            55.92
</pre></div>
</div>
<p>Running this script during the second iteration I also create a NumPy file called <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.iValidPoints</span></code>. To read this file:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">iValidPointsDictionary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span> <span class="p">(</span><span class="s1">&#39;VMCSelectedImages.iValidPoints&#39;</span><span class="p">,</span> <span class="n">allow_pickle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">iValidPointsDictionary</span><span class="o">.</span><span class="n">key</span> <span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;Image File Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Indices Valid Points&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>where the <code class="code docutils literal notranslate"><span class="pre">iValidPointsDictionary</span> <span class="pre">['Image</span> <span class="pre">File</span> <span class="pre">Name']</span></code> is the list of all the included file names, and the <code class="code docutils literal notranslate"><span class="pre">iValidPointsDictionary</span> <span class="pre">['Indices</span> <span class="pre">Valid</span> <span class="pre">Points']</span></code> is the list of lists of indices of the points in the flattened VMC image arrays that are in latitude-longitude boxes.
In this way, I do not need to recalculate these if I need them at some later stage.</p>
<p>Some examples of a some of the selected images for orbit 2811 (South Polar Dynamics Campaign). The <strong>X</strong> indicates the coordinates of the VeRa-observation, and the light gray boxes are the latitude-longitude wind advected areas that correspond to the VeRa-location at the time of the VMC-observation.</p>
<a class="reference internal image-reference" href="_images/V2811_0024_UV2.png"><img alt="_images/V2811_0024_UV2.png" src="_images/V2811_0024_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<a class="reference internal image-reference" href="_images/V2811_0040_UV2.png"><img alt="_images/V2811_0040_UV2.png" src="_images/V2811_0040_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<a class="reference internal image-reference" href="_images/V2811_0060_UV2.png"><img alt="_images/V2811_0060_UV2.png" src="_images/V2811_0060_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<a class="reference internal image-reference" href="_images/V2811_0080_UV2.png"><img alt="_images/V2811_0080_UV2.png" src="_images/V2811_0080_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<a class="reference internal image-reference" href="_images/V2811_0084_UV2.png"><img alt="_images/V2811_0084_UV2.png" src="_images/V2811_0084_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<a class="reference internal image-reference" href="_images/V2811_0088_UV2.png"><img alt="_images/V2811_0088_UV2.png" src="_images/V2811_0088_UV2.png" style="width: 350.0px; height: 280.0px;" /></a>
<p>The top row is from ingress, the bottom two images are from egress. The time of the egress images is very close to the VeRa-observation, as can be clearly seen by the positions of the <strong>X</strong> and the gray boxes. Note also that the size of the gray boxes is small, because the uncertainty in the latitude and longitude is a function of the time difference between the VeRa and VMC observations.</p>
</section>
<section id="step-02-determine-phase-curve">
<span id="vmcstep02"></span><h4>Step 02 - Determine phase curve<a class="headerlink" href="#step-02-determine-phase-curve" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step02</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateTable_PhaseAngleCurve.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateTable_PhaseCurveFit.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">PhaseCurve_i&lt;84_e&lt;81.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">PhaseCurveFit_i&lt;84_e&lt;81.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">PhaseCurve_i&lt;89_e&lt;90.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">PhaseCurveFit_i&lt;89_e&lt;90.dat</span></code></div>
</div>
</div>
<p>In this step, I construct the phase curve.
The 1374 selected images from 73 orbits cover a phase angle range between 27˚ and 140˚.
These images have been selected during <a class="reference internal" href="#vmcstep01"><span class="std std-ref">Step 1</span></a> above and the plots (with the same files names as the .IMG and .GEO files) are located in the :file`UsedImages` subfolders for each orbit.</p>
<p>For each selected image, I use all the pixels on the visible disk and take the average and the median values.
Initially, I had set the incidence and emission angles limits both to 89˚.
I changed that to 84˚ and 81˚ respectively in line with the results presented by <a class="reference internal" href="#lee2015a"><span class="std std-ref">Lee et al. (2015)</span></a> in their section 3.2.
The difference in the final resulting coefficients of the phase angle curve fit are on the order or 2%.</p>
<p>By selecting the valid pixels in this way, I note that there are significant outliers in the radiances, especially in the low value range.
This was also noted by <a class="reference internal" href="#lee2015a"><span class="std std-ref">Lee et al. (2015)</span></a> who adapoted another condition on the selection of the image pixel that the radiance factor be larger than 0.05. I address this perhaps more rigorously using the process described below. In order to avoid the effect of these outliers, I apply an iterative averaging process:</p>
<ul class="simple">
<li><p>Step 1: calculate the average;</p></li>
<li><p>Step 2: check if the current average value is different by more than a given <strong>percentage</strong> (set by the user) from the one from the previous iteration;</p></li>
<li><p>Step 3a: if yes, then remove all the points outside <strong>n</strong> times the standard deviation (<strong>sd</strong>), where <strong>n</strong> is given by the user and return to Step 1;</p></li>
<li><p>Step 3b: if no, then finish.</p></li>
</ul>
<p>I try some values and find that <strong>n</strong> <sub>sd</sub> <strong>= 3</strong> and <strong>percentage = 1%</strong> gives good results.
Here is an example of a sequence of iterations.</p>
<figure class="align-default" id="id14">
<a class="reference internal image-reference" href="_images/V0260_0047_UV2_iteration_QQ_Histogram.jpg"><img alt="_images/V0260_0047_UV2_iteration_QQ_Histogram.jpg" src="_images/V0260_0047_UV2_iteration_QQ_Histogram.jpg" style="width: 325.0px; height: 375.0px;" /></a>
<figcaption>
<p><span class="caption-text">Iterative progression of histogram and QQ plot for image V0260_0047, with <strong>n</strong> <sub>sd</sub> <strong>= 3</strong> and <strong>percentage = 1%</strong>.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>With the script <code class="file docutils literal notranslate"><span class="pre">./CreatePhaseAngleCurveTable.py</span></code> I process all the images and export the results to the <code class="file docutils literal notranslate"><span class="pre">PhaseCurve_i&lt;84_e&lt;81.dat</span></code> table file.</p>
<p>I now look at how to best construct and fit the phase curve to a quadratic polinomial with NumPy’s <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polynomial.polynomial.Polynomial.fit.html">np.polynomial.polynomial.Polynomial.fit ()</a> function.
I create the script <code class="file docutils literal notranslate"><span class="pre">./scripts/ExtractPhaseCurve.py</span></code>.
At first I use <strong>all the data points</strong> as they are and get the following result:</p>
<a class="reference internal image-reference" href="_images/PhaseCurve_allPhaseAngles.png"><img alt="_images/PhaseCurve_allPhaseAngles.png" src="_images/PhaseCurve_allPhaseAngles.png" style="width: 460.79999999999995px; height: 345.59999999999997px;" /></a>
<a class="reference internal image-reference" href="_images/PhaseCurve_allPhaseAngles_detail.png"><img alt="_images/PhaseCurve_allPhaseAngles_detail.png" src="_images/PhaseCurve_allPhaseAngles_detail.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>The fit to the quadratic model is clearly off, the <span class="math notranslate nohighlight">\(r^2\)</span> value is low.</p>
<p>It is clear the Nominal (green) and Extension 1 (blue) mission sections are quite different than the rest. In the detailed plot on the right, there seems to be quite a lot of <em>regularity</em> in the Nominal and Extension 1 data, which I find somewhat suspicious.
Could this be related to calibration issues? When inspecting more closely the values of the Radiance Scaling Factors in
<code class="file docutils literal notranslate"><span class="pre">PhaseCurve_i&lt;84_e&lt;81.dat</span></code> around phase angles of 90˚, I find a number of instances where in the same orbit (consecutive) images have different calibration factors. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   Image          phase angle   Average RF  dAverage RF     Q1 RF  Median RF  Q3 RF   # iterations   Radiance Scaling Factor    # valid data points
                      (˚)                                                                              W/m2/ster/micron/DN

...
V0260_0052_UV2       88.47         0.820      0.1649        0.717    0.807    0.957        1               0.11607                       21249
...
V0260_0048_UV2       89.44         0.845      0.1557        0.756    0.846    0.967        2               0.07738                       20891
...
V0260_0047_UV2       89.47         0.841      0.1546        0.753    0.842    0.960        2               0.09673                       20869
...
</pre></div>
</div>
<p id="unresolvedquestion1">Though looking at the resulting radiance values, these seem to be consistent among each other, which could mean these images have been recorded in different amplifier modes? I cannot seem to find information about this in the header or other metadata with the image (see <a class="reference internal" href="#unresolvedquestionnottoforget"><span class="std std-ref">first unresolved question</span></a>).</p>
<p>When I ignore different sections of data, the phase curve becomes more convincing:</p>
<a class="reference internal image-reference" href="_images/PhaseCurveExtension1-4+SPDC_allPhaseAngles.png"><img alt="_images/PhaseCurveExtension1-4%2BSPDC_allPhaseAngles.png" src="_images/PhaseCurveExtension1-4%2BSPDC_allPhaseAngles.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/PhaseCurveExtension2-4+SPDC_allPhaseAngles.png"><img alt="_images/PhaseCurveExtension2-4%2BSPDC_allPhaseAngles.png" src="_images/PhaseCurveExtension2-4%2BSPDC_allPhaseAngles.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>Finally, discarding the data from the highest phase angles (&gt;=130˚) also seems to help:</p>
<figure class="align-default" id="id15">
<a class="reference internal image-reference" href="_images/PhaseCurveExtension2-4+SPDC_PhaseAngleLT130dgr.png"><img alt="_images/PhaseCurveExtension2-4%2BSPDC_PhaseAngleLT130dgr.png" src="_images/PhaseCurveExtension2-4%2BSPDC_PhaseAngleLT130dgr.png" style="width: 640.0px; height: 480.0px;" /></a>
<figcaption>
<p><span class="caption-text">Ignore data from the Nominal and Extension 1 mission section and phase angles &gt;= 130˚.</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>To further improve the phase curve, I decide not to use the data as is, but rather to bin it in phase angle bins of 1˚ wide, and take the average value within each bin.
I get the following sequence of results (same as above, first all the data, second ignore Nominal mission section, third ignore Nominal and Extension 1 mission sections):</p>
<a class="reference internal image-reference" href="_images/PhaseCurveBinned_allPhaseAngles.png" id="orbitimagesexample"><img alt="_images/PhaseCurveBinned_allPhaseAngles.png" id="orbitimagesexample" src="_images/PhaseCurveBinned_allPhaseAngles.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/PhaseCurveBinnedExtension1-4+SPDC_allPhaseAngles.png"><img alt="_images/PhaseCurveBinnedExtension1-4%2BSPDC_allPhaseAngles.png" src="_images/PhaseCurveBinnedExtension1-4%2BSPDC_allPhaseAngles.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/PhaseCurveBinnedExtension2-4+SPDC_allPhaseAngles.png"><img alt="_images/PhaseCurveBinnedExtension2-4%2BSPDC_allPhaseAngles.png" src="_images/PhaseCurveBinnedExtension2-4%2BSPDC_allPhaseAngles.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>Finally:</p>
<figure class="align-default" id="id16">
<img alt="_images/PhaseCurveBinnedExtension2-4%2BSPDC_PhaseAngleLT130dgr.png" src="_images/PhaseCurveBinnedExtension2-4%2BSPDC_PhaseAngleLT130dgr.png" />
<figcaption>
<p><span class="caption-text">Ignore data from the Nominal and Extension 1 mission section and phase angles &gt;= 130˚ - binned.</span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The grey area around the line is the result of estimating the uncertainty.
To do that I varied the value in each bin by adding a random value to the bin value.
This random value is taken from a normal distribution: the standard deviation of this normal distribution is the maximum of all the uncertainties on the individual values in the bin and the uncertainty as assessed through equation 3.14 of <a class="reference internal" href="#bevington2003"><span class="std std-ref">Bevington and Robinson (2003)</span></a>:</p>
<div class="math notranslate nohighlight">
\[\sigma_v^2 = \sum \sigma_{x_i}^2    \frac{\partial v}{\partial x_i}^2\]</div>
<p>with <span class="math notranslate nohighlight">\(v\)</span> being the average value of <span class="math notranslate nohighlight">\((x_1, x_2, ..., x_N)\)</span>, the individual values in the bin, hence <span class="math notranslate nohighlight">\(v = \sum x_i / N\)</span>, and thus:</p>
<div class="math notranslate nohighlight" id="uncertaintyinaverage">
\[\sigma_v^2 = \sum  \sigma_{xi}^2 / N^2\]</div>
<p>I run this test 1000 times, and for each set of new binned values I recalculate the fit and plot it in light transparent grey. These are the grey areas in the plots, around the fitted phase curves.
I also keep the values for all these tests to estimate the uncertainties in the fitted phase curve. There are possibly two ways to determine this uncertainty. One would be to calculate the standard deviation of the radiance factors of the 1000 experiments for each phase angle bin.
The other is to simply take the difference between the maximum and the minimum value of the 1000 experiments for each phase angle bin.
This second method generally results in larger uncertainties, but not always.
Also, the average value of the 1000 experiments for each phase angle bin should be the same, to within great precision, as the model fit. I verify that this is true to the level of a 0.05% (<span class="math notranslate nohighlight">\(100 * (RF_{model} - RF_{average}) / RF_{model}\)</span>).</p>
<p>Using the <code class="file docutils literal notranslate"><span class="pre">./scripts/ExtractPhaseCurve.py</span></code> I create the <code class="file docutils literal notranslate"><span class="pre">PhaseCurveFit_i&lt;84_e&lt;81.dat</span></code> table file,
that contains the results of these experiments and the different ways to determine the uncertainties.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> File: PhaseCurveFit_i&lt;84_e&lt;81.dat
 Created at 2024-11-09 at 16:53:08
 Created with CreateTable_PhaseCurveFit.py

  RF (pa)= 0.000179 * pa^2 + -0.0222 * pa +   1.189  |  r^2 = 0.960 (pa = phase angle in ˚)

  RF (Fit) = Radiance Factor as fit with the quadratic model above
  RF (Average) = average Radiance Factor from 1000 gaussian noise experiments
  dRF = standard deviation of the Radiance Factor from 1000 gaussian noise experiments
  MaxMin RF = (maximum - minimum) / 2  of the Radiance Factor from 1000 Gaussian noise experiments

   phase angle   RF (Fit)  RF (Average)   dRF     MaxMin RF
       (˚)
C_END
      27.0        0.719       0.716      0.0342    0.1167
      28.0        0.707       0.704      0.0329    0.1119
      29.0        0.695       0.692      0.0316    0.1072
      ...
      ...
     127.0        1.252       1.252      0.0301    0.1014
     128.0        1.276       1.275      0.0315    0.1057
     129.0        1.299       1.299      0.0329    0.1100
     130.0        1.324       1.323      0.0344    0.1144
</pre></div>
</div>
</section>
<section id="step-03-investigate-correlation">
<span id="vmcstep03"></span><h4>Step 03 - Investigate correlation<a class="headerlink" href="#step-03-investigate-correlation" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step03</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CorrelateRadianceFactors_Temperature.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">./scripts/CreateTableAndFigures_RadianceFactorRatio.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatiosPerOrbit.dat</span></code></div>
</div>
</div>
<p>It is now the moment to analyse any correlation between the VeRa-derived temperatures at 70km altitude and the VMC-derived UV-brightness in the same area.</p>
<p>For this part, as for the determination of the phase curve in the previous step, I ignore the selected images from the nominal and the extension 1 sections.
The first orbit in my data set is <code class="file docutils literal notranslate"><span class="pre">Orb1188</span></code> from Extension 2.</p>
<p>The table file <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> contains the average radiance factors inside the latitude-longitude-boxes corresponding to the VeRa-sounding at the time of the image, as well as the phase angle at the time of observation and the VeRa-derived temperature at 70km altitude.
Note that for the South Polar Dynamics Campaign, there are images on both the ingress and egress sections of the orbit, before and after the VeRa sounding.
See also the <a class="reference internal" href="#orbitimagesexample"><span class="std std-ref">examples for orbit 2811</span></a> in <a class="reference internal" href="#vmcstep01"><span class="std std-ref">Step 1</span></a>.</p>
<p>In order to compare the radiance factors between images at different phase angles, they have to be corrected, or normalised, for the phase angle dependency using the phase curve.
To do this, I normalise the radiance factors to the radiance factor of the phase curve at the same phase angle.
I call this variable the Radiance Factor Ratio (<span class="math notranslate nohighlight">\(RFR\)</span>):</p>
<div class="math notranslate nohighlight">
\[RFR = \frac {RF_{measured} (\phi)}{RF_{phase curve} (\phi)}\]</div>
<p>The uncertainty in <span class="math notranslate nohighlight">\(RFR\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\sigma_{RFR}^2 = (\frac {\sigma_{RF-measured}}{RF_{phase curve}})^2 +  (\frac {\sigma_{RF-phase curve} RF_{measured}}{RF_{phase curve}^2})^2\]</div>
<p>I create the script <code class="file docutils literal notranslate"><span class="pre">./scripts/CorrelateRadianceFactors_Temperature.py</span></code> to extract the information from the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> and the <code class="file docutils literal notranslate"><span class="pre">PhaseCurveFit.dat</span></code> and calculate the RFRs as a function of the VeRa-derived temperatures and fit least square lines.</p>
<p>First, look at two separate orbits from the South Polar Dynamics Campaign (2811) and extension 3 (1748):</p>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_images_orbit_2811-2811.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_images_orbit_2811-2811.png" src="_images/RadianceFactorRatio_vs_Temperature_images_orbit_2811-2811.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_images_orbit_1748-1748.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_images_orbit_1748-1748.png" src="_images/RadianceFactorRatio_vs_Temperature_images_orbit_1748-1748.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>There are two groups of points for the orbit 2811.
The RFR values for the egress images very close to the actual VeRa observation in time and place are significantly higher: they are at low phases angle and the amount of points in the boxes is low, <em>i.e.</em> the boxes are very small.
Corresponding to the figure on the left above, below are printed the phase angle, the radiance factor divided by the model phase curve radiance factor and the
resulting RFR and uncertainty (as per the formula above). The number of points in the latitude-longitude box is the last number on each line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go"> 82˚: 0.5710 / 0.5700 = 1.0018 +/- 0.0946 (# points = 702)</span>
<span class="go"> 84˚: 0.5780 / 0.5850 = 0.9880 +/- 0.0897 (# points = 635)</span>
<span class="go"> 85˚: 0.5830 / 0.5930 = 0.9831 +/- 0.0881 (# points = 585)</span>
<span class="go"> 86˚: 0.5910 / 0.6010 = 0.9834 +/- 0.0842 (# points = 535)</span>
<span class="go"> 88˚: 0.6010 / 0.6190 = 0.9709 +/- 0.0793 (# points = 492)</span>
<span class="go"> 89˚: 0.6120 / 0.6280 = 0.9745 +/- 0.0745 (# points = 451)</span>
<span class="go"> 90˚: 0.6060 / 0.6380 = 0.9498 +/- 0.0740 (# points = 401)</span>
<span class="go"> 91˚: 0.6080 / 0.6480 = 0.9383 +/- 0.0656 (# points = 367)</span>
<span class="go"> 93˚: 0.6180 / 0.6700 = 0.9224 +/- 0.0568 (# points = 342)</span>
<span class="go"> 95˚: 0.6390 / 0.6920 = 0.9234 +/- 0.0562 (# points = 311)</span>
<span class="go"> 97˚: 0.6480 / 0.7170 = 0.9038 +/- 0.0584 (# points = 280)</span>
<span class="go">100˚: 0.6780 / 0.7560 = 0.8968 +/- 0.0439 (# points = 261)</span>
<span class="go">103˚: 0.7030 / 0.7980 = 0.8810 +/- 0.0409 (# points = 237)</span>
<span class="go">106˚: 0.7530 / 0.8440 = 0.8922 +/- 0.0413 (# points = 214)</span>
<span class="go">110˚: 0.8150 / 0.9090 = 0.8966 +/- 0.0551 (# points = 187)</span>
<span class="go">115˚: 0.9160 / 0.9990 = 0.9169 +/- 0.0651 (# points = 168)</span>
<span class="go">121˚: 1.1040 / 1.1190 = 0.9866 +/- 0.0804 (# points = 140)</span>
<span class="go">125˚: 1.2660 / 1.2070 = 1.0489 +/- 0.0955 (# points = 129)</span>
<span class="go"> 27˚: 0.9270 / 0.7190 = 1.2893 +/- 0.2003 (# points =   3)</span>
<span class="go"> 29˚: 0.8740 / 0.6950 = 1.2576 +/- 0.1927 (# points =   7)</span>
<span class="go"> 34˚: 0.8000 / 0.6400 = 1.2500 +/- 0.1749 (# points =  13)</span>
</pre></div>
</div>
<p>It can be seen that the statistics for the last three images (which correspond to the points with low phase angles in the <a class="reference internal" href="#orbitimagesexample"><span class="std std-ref">plots here</span></a>), is based on very low numbers, compared to the ingress images.
The uncertainties in the last three are (therefore) larger. I see no obvious reason to discard these images at low phase angles from the analyses though. I did experiment with taking a lower limit for the number of points in a latitude-longitude box. This is described and shown <a class="reference internal" href="#excludinglowphaseangleimages"><span class="std std-ref">below</span></a>.</p>
<p>I also set up the script <code class="file docutils literal notranslate"><span class="pre">./scripts/CreateRadianceFactorRatioTableAndPlots.py</span></code> to create the table <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatiosPerOrbit.dat</span></code>, which lists the orbitsIDs, the median central latitudes of the latitude-longitude boxes of the images in that orbit, the average and median values of the RFR and corresponding uncertainties as derived from the images of that orbit.</p>
<div class="admonition-uncertainties-in-the-case-of-taking-the-average-of-a-set-rfr-values-for-one-orbit admonition">
<p class="admonition-title">uncertainties in the case of taking the average of a set RFR values for one orbit</p>
<p>The uncertainty is the maximum of the uncertainty derived from the <a class="reference internal" href="#uncertaintyinaverage"><span class="std std-ref">averaging formula</span></a> and the standard deviation of the average of the points.
The last value is almost always the larger one. For the South Polar Dynamics Campaign (red points in the figures below) the spread is large due to the ingress and egress value differences.</p>
</div>
<div class="admonition-uncertainties-in-the-case-of-taking-the-median-of-a-set-rfr-values-for-one-orbit admonition">
<p class="admonition-title">uncertainties in the case of taking the median of a set RFR values for one orbit</p>
<p>The uncertainty in the median can be evaluated by means of creating a new set of the data points based on the original set recalculating a median at each new set. Each data point has an associated uncertainty. By taking this uncertainty as the standard deviation for each data point, I use the NumPy <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html">np.random.normal</a> method to create gaussian noise and add it to the data point. I do this whole exercise 1000 times and therefore get 1000 median values. From this set of median values, I calculate the average and the standard deviation. The standard deviation is a measure of the uncertainty in the median (<a class="reference external" href="https://generaltools-for-scientists.readthedocs.io/en/latest/datatools.html#DataTools.DataTools.getMedianAndQuantilesPYtoCPP">DataTools.getMedianAndQuantilesPYtoCPP</a>).</p>
<p>On the other hand, there is the 33 - 67 percentile values for the median of the original set. Half the difference between these two values is also a measure for the spread and the uncertainty.</p>
<p>I take the maximum of these two ways of determining the uncertainty, which in some cases it is the first one, in other cases the second one.</p>
</div>
<p>With this script I can create plots of the RFR values for each orbit as a function of the phase angle and the time difference between the VeRa sounding and the VMC image. This is an important check on the consistency of the RFR values in one orbit, always taking into account the uncertainties.
All the plots are in the <code class="file docutils literal notranslate"><span class="pre">Step03/plots</span></code> subfolder, and are named <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_PhaseAngle_0X.png</span></code> and <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_VeRaVMCTimeDifference_0X.png</span></code>, where <code class="file docutils literal notranslate"><span class="pre">X</span></code> goes from <code class="file docutils literal notranslate"><span class="pre">1</span></code> to <code class="file docutils literal notranslate"><span class="pre">5</span></code>. Below are two examples (<code class="file docutils literal notranslate"><span class="pre">X</span> <span class="pre">=</span> <span class="pre">5</span></code>), the red line is the average and the red area it’s uncertainty, the green is the median and the green area the uncertainty, derived as explained above. These are the values listed in the <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatiosPerOrbit.dat</span></code> file.</p>
<figure class="align-default" id="id17">
<img alt="_images/RadianceFactorRatio_vs_PhaseAngle_05.png" src="_images/RadianceFactorRatio_vs_PhaseAngle_05.png" />
<figcaption>
<p><span class="caption-text">The last set of plots of RFR vs Phase Angle: RadianceFactorRatio_vs_PhaseAngle_05.png</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id18">
<img alt="_images/RadianceFactorRatio_vs_VeRaVMCTimeDifference_05.png" src="_images/RadianceFactorRatio_vs_VeRaVMCTimeDifference_05.png" />
<figcaption>
<p><span class="caption-text">The last set of plots of RFR vs time difference: RadianceFactorRatio_vs_VeRaVMCTimeDifference_05.png</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Below is a plot of all the RFR values per orbit combined into one plot as a function of the VeRa-derived temperature at 70km altitude:</p>
<figure class="align-default" id="id19">
<img alt="_images/RadianceFactorRatio_vs_Temperature_all_images.png" src="_images/RadianceFactorRatio_vs_Temperature_all_images.png" />
<figcaption>
<p><span class="caption-text">The RFR of all the images as a function of VeRa-derived temperature at 70km altitude.</span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>I can make three types of plots:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the RFR of all the images as a function of VeRa-derived temperature;</p></li>
<li><p>the average or median RFR of the images per orbit as a function of VeRa-derived temperatures;</p></li>
<li><p>the temperature-binned version of (2), either the average value or the median.</p></li>
</ol>
</div></blockquote>
<p>When I use all the images with phase angles &lt; 130˚ (see <a class="reference internal" href="#vmcstep02"><span class="std std-ref">Step 02</span></a>), the results are:</p>
<figure class="align-default" id="id20">
<img alt="_images/RadianceFactorRatio_vs_Temperature_all_images.png" src="_images/RadianceFactorRatio_vs_Temperature_all_images.png" />
<figcaption>
<p><span class="caption-text">The RFR of all the images as a function of VeRa-derived temperature at 70km altitude.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Below are the results when averaging (left) or taking the median value (right) for all points per orbit.</p>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_average.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_average.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_average.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_median.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_median.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_median.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>In the next two rows are the results when binning (in temperature) the average (left plot above) or median (right plot above) values per orbit and taking the median value for each bin.
The first bin is centred at 220K, and the next bin is one bin size more, etc.. Depending on the bin size the number of points in the bin is larger or smaller.
I have the <code class="file docutils literal notranslate"><span class="pre">./scripts/CorrelateRadianceFactors_Temperature.py</span></code> print these values. Here is the printed output of the script when running it with a bin width of 4K and taking the average values per orbit for the binning (left plot above):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="o">-------------</span>
 <span class="n">From</span> <span class="n">HandyTools</span><span class="o">.</span><span class="n">readTable</span><span class="p">:</span>
  <span class="n">file</span> <span class="o">../../</span><span class="n">Step01</span><span class="o">/</span><span class="n">VMCSelectedImages</span><span class="o">.</span><span class="n">dat</span> <span class="n">has</span> <span class="n">been</span> <span class="n">loaded</span> <span class="k">with</span>
  <span class="mi">1374</span> <span class="n">data</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">21</span> <span class="n">columns</span>

<span class="o">-------------</span>
 <span class="n">From</span> <span class="n">HandyTools</span><span class="o">.</span><span class="n">readTable</span><span class="p">:</span>
  <span class="n">file</span> <span class="o">../../</span><span class="n">Step02</span><span class="o">/</span><span class="n">PhaseCurveFit</span><span class="o">.</span><span class="n">dat</span> <span class="n">has</span> <span class="n">been</span> <span class="n">loaded</span> <span class="k">with</span>
  <span class="mi">103</span> <span class="n">data</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">5</span> <span class="n">columns</span>

<span class="o">-------------</span>
 <span class="n">From</span> <span class="n">HandyTools</span><span class="o">.</span><span class="n">readTable</span><span class="p">:</span>
  <span class="n">file</span> <span class="o">../../</span><span class="n">Step04</span><span class="o">/</span><span class="n">ThermalTideCorrection</span><span class="o">.</span><span class="n">dat</span> <span class="n">has</span> <span class="n">been</span> <span class="n">loaded</span> <span class="k">with</span>
  <span class="mi">73</span> <span class="n">data</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">6</span> <span class="n">columns</span>

<span class="o">-</span> <span class="n">Step</span> <span class="mi">1</span>

<span class="o">-</span> <span class="n">Step</span> <span class="mi">2</span>
<span class="n">average</span> <span class="o">/</span> <span class="n">median</span>  <span class="o">-</span> <span class="n">fit</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.006414643559761462</span><span class="p">,</span> <span class="mf">2.516518170007531</span><span class="p">,</span> <span class="mf">0.0037711103981126494</span><span class="p">,</span> <span class="mf">0.8664364802878189</span><span class="p">,</span> <span class="mf">0.05085630162342647</span><span class="p">)</span>

<span class="o">-</span> <span class="n">Step</span> <span class="mi">3</span>
  <span class="c1"># points bin between 218.0K and 222.0K = 4</span>
  <span class="c1"># points bin between 222.0K and 226.0K = 9</span>
  <span class="c1"># points bin between 226.0K and 230.0K = 18</span>
  <span class="c1"># points bin between 230.0K and 234.0K = 14</span>
  <span class="c1"># points bin between 234.0K and 238.0K = 9</span>
  <span class="c1"># points bin between 238.0K and 242.0K = 1</span>
  <span class="c1"># points bin between 242.0K and 246.0K = 1</span>

<span class="n">binned</span> <span class="o">-</span> <span class="n">fit</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.004990715508543933</span><span class="p">,</span> <span class="mf">2.1997286452470526</span><span class="p">,</span> <span class="mf">0.0014098858465595796</span><span class="p">,</span> <span class="mf">0.3237496492979553</span><span class="p">,</span> <span class="mf">0.1883384315949026</span><span class="p">)</span>
</pre></div>
</div>
<p>(this print corresponds to the left plot of the second row below).</p>
<p>At all bin sizes (2, 4, and 8K) some bins have 1 point only. Therefore, taking the median value in each bin seems the most cautious approach.</p>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>Note that for the temperature-binned least-square fitting, I have applied a simple weighting: for each temperature-bin the average (or median) value is added the number of times to the set as there are points in the bin. In this way, the bin with few points at the lower and higher extremes of the temperature range are weighing less, whereas for the middle values there are more points per bin, and will count more heavily.</p>
<p>Also note that the temperature binning could be one way to account for variations in the temperature that exist due to gravity waves and thermal tides. Thermal tides can be on the order of +/- 4K (<a class="reference internal" href="#akiba2021"><span class="std std-ref">Akiba et al. 2021</span></a>), so a bin width of 8K would be necessary:</p>
<figure class="align-default">
<img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_8K.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_8K.png" />
</figure>
<p>In above I assumed for simplicity that the cloud tops are at the same level throughout the atmosphere.
However, this is not the case.
In <a class="reference internal" href="#vmcstep03bis"><span class="std std-ref">Step 3bis</span></a> I explore in detail how to take the variation of cloud top temperature into account.
In <a class="reference internal" href="#vmcstep04"><span class="std std-ref">Step 4</span></a> I extract the amplitude of the thermal tide and in <a class="reference internal" href="#vmcstep05"><span class="std std-ref">Step 5</span></a> I analyse the fully corrected temperatures and how they correlate to the RFR.</p>
<p id="excludinglowphaseangleimages"><strong>Excluding the low phase angle images</strong></p>
<p>From the plots above, where I <strong>include all the images</strong> from the ingress and egress sections of the orbits, it looks like an anti-correlation between the VeRa-derived temperature at 70km altitude and the VMC_derived UV-brightness RFR exists, albeit not a very strong one.</p>
<p>When I use the images with phase angles &lt; 130˚ and number of points in the latitude-longitude boxes more then 20, which basically excludes the egress images, the results are:</p>
<figure class="align-default" id="id21">
<img alt="_images/RadianceFactorRatio_vs_Temperature_all_images1.png" src="_images/RadianceFactorRatio_vs_Temperature_all_images1.png" />
<figcaption>
<p><span class="caption-text">The RFR of the images with more than 20 pixel in the latitude-longitude boxes, as a function of VeRa-derived temperature. Note that this excludes the egress images from the South Polar Dynamics Campaign.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_average1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_average1.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_average1.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_median1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_median1.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_median1.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K1.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K1.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K1.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K1.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K1.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K1.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K1.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K1.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K1.png" style="width: 480.0px; height: 360.0px;" /></a>
<figure class="align-default">
<img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_8K1.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_8K1.png" />
</figure>
<p>The anti-correlation is also clear here, with similar (to within the uncertainty) regression values as for the case using all the images.
It can also be nicely seen how the uncertainty of each point is less than for the case of using all the images.
<strong>Since there is no obvious reason to discard the low phase images, moving forward, I chose to include all the images.</strong></p>
<p>Finally, it is interesting to look at just the egress data points, which results in the oposite correlation, but much less convincing.</p>
<figure class="align-default" id="id22">
<img alt="_images/RadianceFactorRatio_vs_Temperature_all_images2.png" src="_images/RadianceFactorRatio_vs_Temperature_all_images2.png" />
<figcaption>
<p><span class="caption-text">The RFR of the images with phase angles &lt; 60˚, which is only the South Polar Dynamics Campaign egress images.</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_average2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_average2.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_average2.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_orbits_median2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_orbits_median2.png" src="_images/RadianceFactorRatio_vs_Temperature_orbits_median2.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K2.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_2K2.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K2.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_2K2.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K2.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_average_4K2.png" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K2.png"><img alt="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K2.png" src="_images/RadianceFactorRatio_vs_Temperature_binned_median_from_median_4K2.png" style="width: 480.0px; height: 360.0px;" /></a>
</section>
<section id="step-03bis-cloud-top-altitudes-as-a-function-of-latitude">
<span id="vmcstep03bis"></span><h4>Step 03bis - Cloud top altitudes as a function of latitude<a class="headerlink" href="#step-03bis-cloud-top-altitudes-as-a-function-of-latitude" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step03bis</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateFigure_CloudTopAltitudesSPICAV-UV.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateFigures_Latitude_Variability.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VMCImagesEvaluate_CloudTopAltitudes.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">Marcq_2020_Figure14.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">Marcq_2020_Figure14.png</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages_CloudTopAltitudes.dat</span></code></div>
</div>
</div>
<p>For simplicity until this point I have assumed the cloud tops to be at 70km altitude everywhere on Venus, and I have used the VeRa temperatures at that altitude.
However, this is not quite correct.
For example, <a class="reference internal" href="#marcq2020"><span class="std std-ref">Marcq et al. 2020</span></a> analyse SPICAV-UV spectra to retrieve the abundance of SO2 at the cloud tops across Venus.
SPICAV-UV is sensitive between 170 and 320nm, VMC is sensitive between 325 and 405nm (<a class="reference internal" href="#calibratingvmcimages"><span class="std std-ref">Calibration of VMC images</span></a>).
From model calculations and fitting to the SPICAV-UV data for the cloud top altitude as a function of latitude they determine the following:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Marcq_2020_Figure14.png"><img alt="_images/Marcq_2020_Figure14.png" src="_images/Marcq_2020_Figure14.png" style="width: 495.0px; height: 468.0px;" /></a>
</figure>
<p>Emmanuel Marcq sent me a selection of the fits that correspond to the orbits 427 to 2811, as well as the values of the red median line of their Figure 14 above (<code class="file docutils literal notranslate"><span class="pre">Marcq_2020_Figure14.dat</span></code>). When I sub-select orbits between 1188 and 2811, the ones I finally use in this analysis, and taking the median in 10˚ wide bins centered
at -85˚, -75˚, etc., I get (<code class="file docutils literal notranslate"><span class="pre">./scripts/CloudTopAltitudesSPICAV-UV.py</span></code>):</p>
<a class="reference internal image-reference" href="_images/SPICAV-UV-Orbits_1193-2811_withO3_binsize_10.png"><img alt="_images/SPICAV-UV-Orbits_1193-2811_withO3_binsize_10.png" src="_images/SPICAV-UV-Orbits_1193-2811_withO3_binsize_10.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/SPICAV-UV-Orbits_1193-2811_withoutO3_binsize_10.png"><img alt="_images/SPICAV-UV-Orbits_1193-2811_withoutO3_binsize_10.png" src="_images/SPICAV-UV-Orbits_1193-2811_withoutO3_binsize_10.png" style="width: 448.0px; height: 336.0px;" /></a>
<p><em>The orange values are the median values resulting from the sub-set of SPICAV data that corresponds to the VMC data set. The red line is from :ref:`Marcq et al. 2020 &lt;Marcq2020&gt;` Figure 14.</em></p>
<p>It can be seen there are roughly two latitude regions: <code class="code docutils literal notranslate"><span class="pre">|latitude|</span> <span class="pre">&lt;</span> <span class="pre">+50˚</span></code> with cloud tops around 72km and <code class="code docutils literal notranslate"><span class="pre">|latitude|</span> <span class="pre">&gt;</span> <span class="pre">+50˚</span></code> with clouds tops near 65km.
This distribution has been known for quite a while and the above result confirms it.</p>
<p>It can be seen that the sub-set with O3 gives similar results when compared with the full-set, with the advantage that the full set has more data points, especially around -40˚ latitude.
The results without O3 also give good results except for the higher latitudes regions both in the North and South.
This is expected (<a class="reference internal" href="#marcq2019"><span class="std std-ref">Marcq et al. 2019</span></a>, Marcq 2024, private communication).
All in all it seems reasonable to use the full-set results, the difference with the sub-sets is within the uncertainties.</p>
<p>I use these cloud top altitudes as a function of latitude to extract the atmospheric temperatures from the VeRa temperature profiles.
in the latitude bin the VeRa data has been recorded.</p>
<p>I can now re-build the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> table that I created in <a class="reference internal" href="#vmcstep01"><span class="std std-ref">Step01</span></a>, where I was using a fixed cloud top altitude of 70km, using these cloud top altitudes as a function of latitude. I put together the script <code class="file docutils literal notranslate"><span class="pre">VMCImagesEvaluate_CloudTopAltitudes.py</span></code> to perform this task.
I take the latitudes to be those of the VeRa soundings at 70km altitude. The corresponding VMC latitude-longitude box central latitudes are very similar.
In addition, to that with a 10˚-latitude binning (bins are 10˚ wide and centred at -85˚, -75˚, etc.) in <code class="file docutils literal notranslate"><span class="pre">Marcq_2020_Figure14.dat</span></code>, choosing either the VeRa latitude at 70km (or even 60km or 80km altitude) or the VMC latitude results in the same choice of altitude level.
I extract the VeRa temperatures at these levels and place them in the adapted <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages_CloudTopAltitudes.dat</span></code> table.</p>
<p>It is useful to look at how the cloud top temperatures extracted from the VeRa profiles and the VMC-UV Radiance Factors as a function of latitude are distributed (<code class="file docutils literal notranslate"><span class="pre">Latitude_variability.py</span></code>):</p>
<a class="reference internal image-reference" href="_images/cloudTopTemperatureVeRa_orbitLimit_0.png"><img alt="_images/cloudTopTemperatureVeRa_orbitLimit_0.png" src="_images/cloudTopTemperatureVeRa_orbitLimit_0.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/cloudTopTemperatureVeRa_orbitLimit_1188.png"><img alt="_images/cloudTopTemperatureVeRa_orbitLimit_1188.png" src="_images/cloudTopTemperatureVeRa_orbitLimit_1188.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_0.png"><img alt="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_0.png" src="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_0.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_1188.png"><img alt="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_1188.png" src="_images/radianceFactorsRatiosMedianVMCPerOrbit_orbitLimit_1188.png" style="width: 448.0px; height: 336.0px;" /></a>
<p><em>Cloud top altitudes and corresponding VeRa temperatures as a function of latitude for all orbitsIDs in this study (&gt;= 260, left column) and orbitIDs &gt;= 1188 (right column). The cloud top altitudes are from</em> <a class="reference internal" href="#marcq2020"><span class="std std-ref">Marcq et al. 2020</span></a> <em>their Figure 14. Note that there a few more VeRa profiles compared to the VMC-UV Radiance Factor Ratios, because not all orbits for which there were VeRa and VMC measurements have VMC data that was deemed good enough</em> (<a class="reference internal" href="#vmcstep01"><span class="std std-ref">VMC/Step01</span></a>).</p>
<p>From pure visual inspection of the figure, there seems to be a linear-ish variation in the cloud top temperatures with latitude.
To my knowledge there is not obvious physical reason to expect any correlation of this kind though.</p>
<p>Could some of the variation in the temperatures be due to the UV-absorber?
In two figures below there there might be a very very faint variation of the UV radiance factor ratios as a function of latitude, also increasing towards the pole.
There is a lot of variation however.</p>
<p>Not sure (yet), but perhaps this figure is a rather new result?
I combine the cloud top altitude derived from modeling SPICAV-UV spectra to the VeRa temperatures, was this ever done before in this manner? Need to check the literature!
In terms of the cloud top altitudes, there are four levels, indicated by the green circles: 65km, 71km, 73km and 74km, though for the last level there are only two data points.
The temperature gradient in this altitude range is rather complex, changing from negative to positive and back (see figures in <a class="reference internal" href="#verastep02"><span class="std std-ref">Vera Step02</span></a>).</p>
<p>How much of the change in cloud top temperatures as a function of latitude and altitude is due to the temperature gradient?
I try to address this question by plotting temperature gradients in three ways (<code class="file docutils literal notranslate"><span class="pre">Latitude_variability.py</span></code>):</p>
<ol class="arabic simple">
<li><p>the temperature gradient at the cloud top level (top row below);</p></li>
<li><p>the average temperature gradient in the 65 - 74km altitude region (middle row below);</p></li>
<li><p>the median temperature gradient in the 65 - 74km altitude region (bottom row below);</p></li>
</ol>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_CloudTops_orbitLimit_0.png"><img alt="_images/temperatureGradientVeRa_CloudTops_orbitLimit_0.png" src="_images/temperatureGradientVeRa_CloudTops_orbitLimit_0.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_CloudTops_orbitLimit_1188.png"><img alt="_images/temperatureGradientVeRa_CloudTops_orbitLimit_1188.png" src="_images/temperatureGradientVeRa_CloudTops_orbitLimit_1188.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_0.png"><img alt="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_0.png" src="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_0.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_1188.png"><img alt="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_1188.png" src="_images/temperatureGradientVeRa_Average65-74km_orbitLimit_1188.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_0.png"><img alt="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_0.png" src="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_0.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_1188.png"><img alt="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_1188.png" src="_images/temperatureGradientVeRa_Median65-74km_orbitLimit_1188.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>In the plots above I also report the average and median values of the temperature gradients as a function of latitude.
What I see from these plots and the average / median values above is that the temperature gradient in the relevant altitude range is on the order of -1 K/km.
However, there is a 20K cloud top temperature variation with latitude, spanning the 65 - 74km altitude range in terms of cloud top levels, which would require a temperature gradient on the order of -2 K/km.
So it looks like it is safe to state that about <strong>half of the temperature variation in the cloud top temperatures as a function of latitude</strong> is due to the temperature gradient. What is the other half?</p>
<p>This analysis could probably be taken further in more detail!</p>
</section>
<section id="step-04-thermal-tide-correction">
<span id="vmcstep04"></span><h4>Step 04 - Thermal tide correction<a class="headerlink" href="#step-04-thermal-tide-correction" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step04</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateFigures_ThermalTideCheck69km.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTable_ThermalTide_Akiba2021_Figure5.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTable_ThermalTideCorrection.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">temp_devi_contour_lt_to_lat_distributions_at_constant_altitude_each_value_whole_wider_period.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">ThermalTideCorrection.dat</span></code></div>
</div>
</div>
<p>There are thermal tides and gravity waves that affect the temperature in the atmosphere.
Thermal tides are fixed in Local Solar Time.
I want to evaluate the effect of correcting VeRa-derived temperatures for the thermal tide.
I take one of the most recent publications I can find, based on Akatsuki NIR data, <a class="reference internal" href="#akiba2021"><span class="std std-ref">Akiba et al. 2021</span></a>. In their Figure 5, they present the thermal tide anomaly for all latitudes between -62˚.5 and +62˚.5 latitude at 69km altitude, which is only 1km below the VeRa-sounded level analysed here, well within a scale height. The values in the figure are the deviations from the mean zonal temperature at each latitude.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Akiba_2021_Figure5.png"><img alt="_images/Akiba_2021_Figure5.png" src="_images/Akiba_2021_Figure5.png" style="width: 794.0px; height: 609.0px;" /></a>
</figure>
<p>The corresponding data files (tables) can be found at <a class="reference external" href="https://doi.org/10.5281/zenodo.5159027">this Zenodo repository</a>.
From the <code class="file docutils literal notranslate"><span class="pre">temp_devi_contour_lt_to_lat_distributions_at_constant_altitude_each_value_whole_wider_period.csv</span></code> file found in the <code class="file docutils literal notranslate"><span class="pre">Figure_data_csv/Figure5</span></code> directory of that repository I create a more human (and HandyTools.readTable) readable table <code class="file docutils literal notranslate"><span class="pre">temp_devi_contour_lt_to_lat_distributions_at_constant_altitude_each_value_whole_wider_period.dat</span></code> using the <code class="file docutils literal notranslate"><span class="pre">./scripts/createTable_ThermalTide_Akiba2021_Figure5.py</span></code> script.</p>
<p>In the caption of Figure 3 of their paper (the figure shows temperature cross section of thermal tides as a function LST in the northern hemisphere only) it is stated that <strong>… the local time is in the opposite direction to that on Venus as mapped by cylindrical projection. The direction of the mean zonal wind is from left to right</strong>. I verify by corresponding with the authors that this is also valid for the other figures in the paper. What I find to be confusing in this statement, or at least the way I interpret it, is that it seems as if there are <strong>two Local Solar Times</strong>: one <strong>on Venus</strong> and another one … of <strong>the figure</strong>?
The <a class="reference internal" href="#appendixlongitudeandlocalsolartime"><span class="std std-ref">wind is in the direction of increasing LST</span></a>, hence the last part of their statement corroborates with that.</p>
<p>In the script <code class="file docutils literal notranslate"><span class="pre">CreateTable_ThermalTide_Akiba2021_Figure5</span></code> I take the data from the thermal tide table and the latitudes and LST values for each VeRa sounding from the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages.dat</span></code> table. I apply linear interpolation first in latitude and then in LST of the values in the <code class="file docutils literal notranslate"><span class="pre">temp_devi_contour_lt_to_lat_distributions_at_constant_altitude_each_value_whole_wider_period.dat</span></code> table to estimate the amplitude of the thermal tide for each VeRa sounding location. I write the results in the <code class="file docutils literal notranslate"><span class="pre">ThermalTideCorrection.dat</span></code> table file.</p>
<p>I adapt the <code class="file docutils literal notranslate"><span class="pre">./scripts/CorrelateRadianceFactors_Temperature.py</span></code> script in <a class="reference internal" href="#vmcstep03"><span class="std std-ref">Step03</span></a> to allow taking into account (subtract) thermal tide amplitude from the <code class="file docutils literal notranslate"><span class="pre">ThermalTideCorrection.dat</span></code> table file.</p>
<p>The problem is that the information about thermal tides from this paper only exists for a limited range, about 65 - 72km altitude. I want to analyse the full 50 - 80km altitude, see <a class="reference internal" href="#vmcstep06"><span class="std std-ref">Step06</span></a>.</p>
<p>However, it is useful evaluate the effect of applying a correction to the correlation results in <a class="reference internal" href="#vmcstep06"><span class="std std-ref">Step06</span></a>.
For this I take the VeRa temperature values at 69km altitude and compare the Pearson and Spearman correlation coefficients and associated uncertainties when applying or not applying a thermal tide correction (script <code class="file docutils literal notranslate"><span class="pre">CreateFigures_ThermalTideCheck69km.py</span></code>):</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-40_0.png"><img alt="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-40_0.png" src="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-40_0.png" style="width: 480.0px; height: 360.0px;" /></a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-60_-40.png"><img alt="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-60_-40.png" src="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-60_-40.png" style="width: 480.0px; height: 360.0px;" /></a>
</figure>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-90_-60.png"><img alt="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-90_-60.png" src="_images/Temperature69km_vs_RadianceFactorRatio_latitudes_-90_-60.png" style="width: 480.0px; height: 360.0px;" /></a>
</figure>
<p>The blue dots are the uncorrected temperatures and the above correspond to the exact figures for 69km altitude in
<code class="file docutils literal notranslate"><span class="pre">Step06/plots_T/Latitudes_-39_-14/</span></code>, <code class="file docutils literal notranslate"><span class="pre">Step06/plots_T/Latitudes_-59_-43</span></code> and <code class="file docutils literal notranslate"><span class="pre">Step06/plots_T/Latitudes_-83_-62</span></code>.</p>
<p>It is clear from the comparison of the values and uncertainties of the correlation coefficients that the thermal tide correction does not significantly change the correlation statistics. I will not attempt to apply the thermal tide correction in the final analysis.</p>
<p>The uncertainty in the thermal tide amplitude seems to be on the order of <span class="math notranslate nohighlight">\(\pm\)</span> 0.1K (Figure 7 from <a class="reference internal" href="#akiba2021"><span class="std std-ref">Akiba et al.</span></a>), but I do not take this into account in the above.</p>
</section>
<section id="step-05-first-correlation-analysis">
<span id="vmcstep05"></span><h4>Step 05 - First correlation analysis<a class="headerlink" href="#step-05-first-correlation-analysis" title="Link to this heading"></a></h4>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step05</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTableAndFigures_CorrelateRadianceFactorRatios_T_CloudTopAltitudes.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">cloudTopTemperature_vs_RadianceFactorRatio.dat</span></code></div>
</div>
</div>
<p>I think there are two ways to approach the analysis of a correlation between the cloud top temperatures and UV-brightness, based on the results from the steps above.
I set up the script <code class="file docutils literal notranslate"><span class="pre">CorrelateRadianceFactorRatios_T_CloudTopAltitudes.py</span></code> for both these ways and use the <code class="file docutils literal notranslate"><span class="pre">VMCSelectedImages_CloudTopAltitudes.dat</span></code> table from <a class="reference internal" href="#vmcstep03bis"><span class="std std-ref">Step 3bis</span></a> as well as <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatiosPerOrbit.dat</span></code> from <a class="reference internal" href="#vmcstep03"><span class="std std-ref">Step 3</span></a></p>
<p>The <strong>first</strong> way is to split the analysis in several latitude sections.
These sections would logically be defined by the changes in cloud top altitudes, as indicated by the green points in the figures above in <a class="reference internal" href="#vmcstep03bis"><span class="std std-ref">Step 3bis</span></a>: 65km for latitudes &lt; -60˚, 71km for latitudes between -60˚ and -40˚, 73km for latitudes between -40˚ and -15˚.</p>
<a class="reference internal image-reference" href="_images/cloudTopTemperature_65km_vs_RadianceFactorRatio.png"><img alt="_images/cloudTopTemperature_65km_vs_RadianceFactorRatio.png" src="_images/cloudTopTemperature_65km_vs_RadianceFactorRatio.png" style="width: 512.0px; height: 384.0px;" /></a>
<a class="reference internal image-reference" href="_images/cloudTopTemperature_71km_vs_RadianceFactorRatio.png"><img alt="_images/cloudTopTemperature_71km_vs_RadianceFactorRatio.png" src="_images/cloudTopTemperature_71km_vs_RadianceFactorRatio.png" style="width: 512.0px; height: 384.0px;" /></a>
<a class="reference internal image-reference" href="_images/cloudTopTemperature_73km_vs_RadianceFactorRatio.png"><img alt="_images/cloudTopTemperature_73km_vs_RadianceFactorRatio.png" src="_images/cloudTopTemperature_73km_vs_RadianceFactorRatio.png" style="width: 512.0px; height: 384.0px;" /></a>
<p>The cloud top temperatures have been corrected for the thermal tide at 69km altitude (<code class="file docutils literal notranslate"><span class="pre">ThermalTideCorrection.dat</span></code>) as described in <a class="reference internal" href="#vmcstep04"><span class="std std-ref">Step04</span></a>), even though none of the cloud top altitudes is exactly at 69km altitude: I assume this amplitude to be a good indication.
I also determined linear fits to the points, but clearly the linear correlation is very weak if even existent at all.</p>
<p>I need to do another statistical analysis test here!</p>
<p>The <strong>second</strong> way I correct the cloud top temperature variation due to the temperature gradient in the atmosphere,
so that the values can be compared across latitudes when doing the correlation with the VMC UV-brightness.
I take 71km altitude as the reference level:</p>
<div class="math notranslate nohighlight">
\[dT = \frac {dT}{dz}_{average} \times (71 - z_{cloud-top})\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\frac {dT}{dz}_{average} = -1K/km\]</div>
<p>Hence, the cloud top temperatures at 65km altitude would be 6K lower due to the average temperature gradient if they were at 71km, the cloud top temperatures at 73km would be 2K higher.</p>
<a class="reference internal image-reference" href="_images/cloudTopTemperatureCorrected_vs_RadianceFactorRatio.png"><img alt="_images/cloudTopTemperatureCorrected_vs_RadianceFactorRatio.png" src="_images/cloudTopTemperatureCorrected_vs_RadianceFactorRatio.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>Except for a slight hint at a positive correlation, it is very very weak.</p>
</section>
<section id="step-06-final-correlation-analysis">
<span id="vmcstep06"></span><h4>Step 06 - Final correlation analysis<a class="headerlink" href="#step-06-final-correlation-analysis" title="Link to this heading"></a></h4>
<a class="reference internal image-reference" href="_images/construction.png" id="lastpointofwork"><img alt="_images/construction.png" id="lastpointofwork" src="_images/construction.png" style="width: 80.0px; height: 80.0px;" /></a>
<div class="admonition-directory-scripts-files admonition">
<p class="admonition-title">directory, scripts &amp; files</p>
<div class="line-block">
<div class="line">top directory: <code class="file docutils literal notranslate"><span class="pre">VMC/Step6</span></code></div>
<div class="line">scripts:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateFigures_CorrelationStatistics.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateFigures_LatitudeVariability.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTable_RadianceFactorRatio_vs_T-SVeRa.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTable_T-S_vs_LatitudeVariability.py</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">CreateTablesAndFigures_CorrelationAnalysis.py</span></code></div>
<div class="line">files:</div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_TVeRa50-80kmAltitude.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_SVeRa50-80kmAltitude.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">SVeRa_vs_latitude_statistics_50-80kmAltitude.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">TVeRa_vs_latitude_statistics_50-80kmAltitude.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">S_Correlation_All_Latitudes.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">S_Correlation_Latitudes_0_-40.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">S_Correlation_Latitudes_-40_-60.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">S_Correlation_Latitudes_-60_-90.dat</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">T_Correlation_All_Latitudes_normalised.dat</span></code>  or <code class="file docutils literal notranslate"><span class="pre">_uncorrected</span></code>, <code class="file docutils literal notranslate"><span class="pre">_subtracted</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">T_Correlation_Latitudes_0_-40_normalised.dat</span></code>  or <code class="file docutils literal notranslate"><span class="pre">_uncorrected</span></code>, <code class="file docutils literal notranslate"><span class="pre">_subtracted</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">T_Correlation_Latitudes_-40_-60_normalised.dat</span></code>  or <code class="file docutils literal notranslate"><span class="pre">_uncorrected</span></code>, <code class="file docutils literal notranslate"><span class="pre">_subtracted</span></code></div>
<div class="line"><code class="file docutils literal notranslate"><span class="pre">T_Correlation_Latitudes_-60_-90_normalised.dat</span></code>  or <code class="file docutils literal notranslate"><span class="pre">_uncorrected</span></code>, <code class="file docutils literal notranslate"><span class="pre">_subtracted</span></code></div>
</div>
</div>
<p>In the initial draft paper from 2015, we looked at the RFR values as a function of the temperatures and static stabilities at the same altitude level between 50 and 80km altitude. The idea is that the UV-deposition depth, and hence the level that we actually sound in the UV-filter, is not well known and should be rather diffuse, but in the 70 +/- 4km altitude range, as can be seen from the figures in <a class="reference internal" href="#crisp1986"><span class="std std-ref">Crisp (1986)</span></a> and <span class="xref std std-ref">Lee et al. (2015b) &lt;Lee2015b</span>.</p>
<p>We separated this analysis in several latitude bins to avoid as much as possible the effect of the change in temperature as a function of latitude.
So I can do that again, but I think only three latitude bins are necessary. When I look at the variation of the RFR with latitude I see:</p>
<p>First I create the tables <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_TVeRa50-80kmAltitude.dat</span></code> and <code class="file docutils literal notranslate"><span class="pre">RadianceFactorRatio_vs_SVeRa50-80kmAltitude.dat</span></code>
using the <code class="file docutils literal notranslate"><span class="pre">CreateTable_RadianceFactorRatio_vs_T-SVeRa.py</span></code> script. With this script I extract the temperatures at the 31 levels and export them to
the tables. It makes life a bit easier than needing to extract these values from the original file all the time.</p>
<p>Secondly, I looked at the variability of temperature and RFR with latitude.
With the script <code class="file docutils literal notranslate"><span class="pre">CreateFigures_LatitudeVariability.py</span></code> I create several plots:</p>
<figure class="align-default" id="id23">
<span id="figurerfrlatitudevariability"></span><img alt="_images/Radiance_vs_latitude_variability.png" src="_images/Radiance_vs_latitude_variability.png" />
<figcaption>
<p><span class="caption-text">RFR versus latitude, the green lines are the boundaries of the latitude bins.</span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The mid latitudes have generally higher UV-brightness as compared to the low latitudes and high latitudes.
Based on this, and on the cloud top altitudes variations reported by <a class="reference internal" href="#marcq2019"><span class="std std-ref">Marcq et al. (2019)</span></a> and <a class="reference internal" href="#lee2012"><span class="std std-ref">Lee et al. (2012)</span></a>, I decide on three latitudes bins, 0˚ - -40˚, -40˚ - -60˚ and -60˚ - -90˚. This should compensate for any latitudinal variation of RFR.</p>
<a class="reference internal image-reference" href="_images/Temperature_vs_latitude_variability_examples.png"><img alt="_images/Temperature_vs_latitude_variability_examples.png" src="_images/Temperature_vs_latitude_variability_examples.png" style="width: 300.0px; height: 500.0px;" /></a>
<a class="reference internal image-reference" href="_images/SpearmanPearsonCorrelationCoefficient_T_vs_latitude.png"><img alt="_images/SpearmanPearsonCorrelationCoefficient_T_vs_latitude.png" src="_images/SpearmanPearsonCorrelationCoefficient_T_vs_latitude.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>The right plot above show the Spearman (blue) and Pearson (red) correlation coefficients of the variability of temperature with latitude between 50 and 80km altitude (<code class="file docutils literal notranslate"><span class="pre">TVeRa_vs_latitude_statistics_50-80kmAltitude.dat</span></code>).</p>
<p>Here is the same for the static stability:</p>
<a class="reference internal image-reference" href="_images/Staticstability_vs_latitude_variability_examples.jpg"><img alt="_images/Staticstability_vs_latitude_variability_examples.jpg" src="_images/Staticstability_vs_latitude_variability_examples.jpg" style="width: 300.0px; height: 500.0px;" /></a>
<a class="reference internal image-reference" href="_images/SpearmanPearsonCorrelationCoefficient_S_vs_latitude.png"><img alt="_images/SpearmanPearsonCorrelationCoefficient_S_vs_latitude.png" src="_images/SpearmanPearsonCorrelationCoefficient_S_vs_latitude.png" style="width: 640.0px; height: 480.0px;" /></a>
<p>Initially I did the rest of the analysis with the three latitude bins as defined above and no further corrections. In terms of the variability of the temperature with latitude, it can be seen from the figure above that in the 65-70km altitude range, there is no significant correlation, both the Spearman and Pearson correlation coefficients are smaller than 0.5. However, at lower and higher altitudes there is a quite strong correlation, which in addition can be described with a line (Pearson correlation coefficient), though I am not sure why this would be linear.
Even within the latitude bins, there is still quite some variation of the temperature at these altitudes.
Hence, I think it would be better to correct for it.
I could either subtract the least square fitted line at each altitude from the observed values, or, perhaps more accurate, normalise all the observed values to the least square fitted line.</p>
<p>With the <code class="file docutils literal notranslate"><span class="pre">CreateTable_T-S_vs_LatitudeVariability.py</span></code> I create the <code class="file docutils literal notranslate"><span class="pre">TVeRa_vs_latitude_statistics_50-80kmAltitude.dat</span></code> table, as well as the <code class="file docutils literal notranslate"><span class="pre">SVeRa_vs_latitude_statistics_50-80kmAltitude.dat</span></code> table, that contain the least square line fitting parameters, the Spearman and Pearson correlation coefficients and their uncertainties (see Figures above and the <code class="file docutils literal notranslate"><span class="pre">CreateFigures_LatitudeVariability.py</span></code> script).</p>
<p>Using the <code class="file docutils literal notranslate"><span class="pre">CreateTablesAndFigures_CorrelationAnalysis.py</span></code> script I create a series of table files and plots:
the <code class="file docutils literal notranslate"><span class="pre">T_Correlation_N_C.dat</span></code>, where <code class="file docutils literal notranslate"><span class="pre">N</span></code> is the latitude bin and <code class="file docutils literal notranslate"><span class="pre">C</span></code> is file:<cite>uncorrected</cite> file:<cite>normalised</cite> or file:<cite>subtracted</cite>, and
the <code class="file docutils literal notranslate"><span class="pre">S_Correlation_N_uncorrected.dat,</span> <span class="pre">as</span> <span class="pre">well</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">all</span> <span class="pre">the</span> <span class="pre">corresponding</span> <span class="pre">plots</span>
<span class="pre">in</span> <span class="pre">the</span> <span class="pre">:file:`plots_S</span></code>, <code class="file docutils literal notranslate"><span class="pre">plots_T_uncorrected</span></code>, <code class="file docutils literal notranslate"><span class="pre">plots_T_normalised</span></code>, and <code class="file docutils literal notranslate"><span class="pre">plots_T_subtracted</span></code> folders.</p>
<p>As example, the RFR versus normalised temperature at <strong>68km altitude</strong> for the three latitude bins:</p>
<a class="reference internal image-reference" href="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_0_-40.png"><img alt="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_0_-40.png" src="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_0_-40.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-40_-60.png"><img alt="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-40_-60.png" src="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-40_-60.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-60_-90.png"><img alt="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-60_-90.png" src="_images/Temperature68km_vs_RadianceFactorRatio_latitudes_-60_-90.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>As example, the RFR versus static stability at <strong>57km altitude</strong> for the three latitude bins:</p>
<a class="reference internal image-reference" href="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_0_-40.png"><img alt="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_0_-40.png" src="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_0_-40.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-40_-60.png"><img alt="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-40_-60.png" src="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-40_-60.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-60_-90.png"><img alt="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-60_-90.png" src="_images/StaticStability57km_vs_RadianceFactorRatio_latitudes_-60_-90.png" style="width: 320.0px; height: 240.0px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important to note the difference in the number of points per latitude bin: 9 for (0˚, -40˚), 30 for (-40˚, -60˚) and 17 for (-60˚, -90˚)!</p>
</div>
<p>Finally, using the <code class="file docutils literal notranslate"><span class="pre">CreateFigures_CorrelationStatistics.py</span></code> script, I create all the figures of the correlation analysis: the plots of the Spearman and
Pearson correlation coefficients for the RFR versus uncorrected (normalised, subtracted) temperatures and the static stabilities for all the 31
levels between 50 and 80km altitude.</p>
<p>The results and interpretation are in the next section.</p>
</section>
</section>
<section id="results-and-interpretation">
<span id="resultsandinterpretation"></span><h3>Results and interpretation<a class="headerlink" href="#results-and-interpretation" title="Link to this heading"></a></h3>
<p>First of all I note that both correlations, Radiance Factor Ratio versus static stability and Radiance Factor Ratio versus temperature, are noisy.
This is the result of all the propagated uncertainties in the entire analysis process.
Because I tried to thoroughly take into account the uncertainties, I am convinced of the validity of the correlation results, their final uncertainties
and what can or cannot be concluded.</p>
<p>In terms of significance of the correlation, when the Spearman (Pearson) correlation coefficient is larger than (smaller than) (-)+0.5, there is a good
indication of correlation.</p>
<section id="radiance-factor-ratio-vs-static-stability">
<h4>Radiance Factor Ratio vs static stability<a class="headerlink" href="#radiance-factor-ratio-vs-static-stability" title="Link to this heading"></a></h4>
<p>The correlation results for RFR versus <strong>static stability</strong>: Spearman correlation coefficients (left) and Pearson correlation coefficients (right):</p>
<a class="reference internal image-reference" href="_images/S_Correction_Spearman.png"><img alt="_images/S_Correction_Spearman.png" src="_images/S_Correction_Spearman.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/S_Correction_Pearson.png"><img alt="_images/S_Correction_Pearson.png" src="_images/S_Correction_Pearson.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>First of all the correlation between Radiance Factor Ratio and static stability is very noisy and not significant, except for one peak in the low
latitude bin at 57km altitude.</p>
</section>
<section id="radiance-factor-ratio-vs-temperature">
<h4>Radiance Factor Ratio vs temperature<a class="headerlink" href="#radiance-factor-ratio-vs-temperature" title="Link to this heading"></a></h4>
<p>The correlation results for RFR versus <strong>uncorrected</strong> temperature between 50-80km altitude: Spearman correlation coefficients (left) and Pearson correlation coefficients (right):</p>
<a class="reference internal image-reference" href="_images/T_correlation_uncorrected_Spearman.png"><img alt="_images/T_correlation_uncorrected_Spearman.png" src="_images/T_correlation_uncorrected_Spearman.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/T_correlation_uncorrected_Pearson.png"><img alt="_images/T_correlation_uncorrected_Pearson.png" src="_images/T_correlation_uncorrected_Pearson.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>The correlation results for RFR versus <strong>subtracted</strong> temperature between 50-80km altitude: Spearman correlation coefficients (left) and Pearson correlation coefficients (right):</p>
<a class="reference internal image-reference" href="_images/T_correlation_subtracted_Spearman.png"><img alt="_images/T_correlation_subtracted_Spearman.png" src="_images/T_correlation_subtracted_Spearman.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/T_correlation_subtracted_Pearson.png"><img alt="_images/T_correlation_subtracted_Pearson.png" src="_images/T_correlation_subtracted_Pearson.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>The correlation results for RFR versus <strong>normalised</strong> temperature between 50-80km altitude: Spearman correlation coefficients (left) and Pearson correlation coefficients (right):</p>
<a class="reference internal image-reference" href="_images/T_correlation_normalised_Spearman.png"><img alt="_images/T_correlation_normalised_Spearman.png" src="_images/T_correlation_normalised_Spearman.png" style="width: 448.0px; height: 336.0px;" /></a>
<a class="reference internal image-reference" href="_images/T_correlation_normalised_Pearson.png"><img alt="_images/T_correlation_normalised_Pearson.png" src="_images/T_correlation_normalised_Pearson.png" style="width: 448.0px; height: 336.0px;" /></a>
<p>I take the <strong>normalised</strong> temperature results as the final results.
The correlation has more structure. I think there is good hint for an anti-correlation in the 65-70km altitude range for the low and mid-latitudes.
For the high latitudes it is opposite, but weak in this altitude range.
There is anti-correlation also for all latitude bins around 60km altitude, but overal somewhat weaker.</p>
<p>Could this be a detection, though faint, of the solar UV-energy deposition in the atmosphere at the cloud top levels?
It would corroborate with the radiative forcing studies by <a class="reference internal" href="#crisp1986"><span class="std std-ref">Crisp (1986)</span></a> and <a class="reference internal" href="#lee2015b"><span class="std std-ref">Lee et al. (2015b)</span></a>.
The cloud tops are lower in the high altitudes. An anti-correlation would mean that when UV-energy is absorbed (darker UV, more UV-absorber),
it results in an increase in the atmospheric temperature: hence the temperature would not be one-to-one related to origin of the UV-absorber.</p>
<p>A second, much more challenging hint, is that the trend of the correlation from 50 to 80km altitude: it seems to go from correlation to anti-correlation for
the low and mid latitudes and the other way around for the high latitudes. Though it is a faint signal.</p>
</section>
</section>
<section id="appendix-longitude-and-local-solar-time-on-venus">
<span id="appendixlongitudeandlocalsolartime"></span><h3>Appendix: Longitude and Local Solar Time on Venus<a class="headerlink" href="#appendix-longitude-and-local-solar-time-on-venus" title="Link to this heading"></a></h3>
<p>I (obviously) need to make sure I do the comparisons between Venus Express data and Akatsuki data / results correctly. Confusion on my end about definition of Local (Solar) Time and the direction of (East) longitude triggered me looking into this topic and I went into some length to fully understand rotation directions and longitude definitions.
Referring to <a class="reference internal" href="#archinal2018"><span class="std std-ref">Archinal et al. 2018</span></a> (their Section 2 and Figure 1):</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/Archinal_2018_Figure1.png"><img alt="_images/Archinal_2018_Figure1.png" src="_images/Archinal_2018_Figure1.png" style="width: 317.0px; height: 355.5px;" /></a>
</figure>
<ul class="simple">
<li><p>The North pole of a planet is defined on the <em>north side of the invariable plane of the solar system</em>;</p></li>
<li><p>The <em>direction of East</em> is counter clockwise when looking down from the North;</p></li>
<li><p>The prime meridian is defined by a surface feature, often a crater;</p></li>
<li><p>There is a definition of the nodes of the crossing of the planet’s equatorial plane with that of the International Celestial Reference System (ICRF);</p></li>
<li><p>The angle <strong>W</strong> between the node at +90˚ and the prime meridian is measured in <em>easterly</em> direction along the planet’s equator;</p></li>
<li><p>If the rotation of the planet is <em>prograde</em> (counter-clockwise seen from the North), then <strong>W</strong> increases with time. This is the case for the Earth. It means that for a given Solar Time (point fixed relative to the Sun direction), East longitude decreases with time;</p></li>
<li><p>If the rotation of the planet is <em>retrograde</em> (clockwise seen from the North), then <strong>W</strong> decreases with time. This is the case for the Venus. It means that for a given Solar Time (point fixed relative to the Sun direction), East longitude increases with time.</p></li>
</ul>
<p>This means that looking down at the south pole of Venus, which is the orientation of the VEX VMC images used in this work, the rotation of the planet is counter-clockwise, and the (East) longitude increases in the clockwise direction. This is the case (see also <a class="reference external" href="https://venustools.readthedocs.io/en/latest/vmctools.html#VMCTools.VMCTools.readVMCImageAndGeoCube">VMCTools.readVMCImageAndGeoCube</a>):</p>
<figure class="align-default" id="id24">
<a class="reference internal image-reference" href="_images/longitudeTransformationCheck.png"><img alt="_images/longitudeTransformationCheck.png" src="_images/longitudeTransformationCheck.png" style="width: 1000.0px; height: 408.8px;" /></a>
<figcaption>
<p><span class="caption-text">(left) the values in the longitude backplane of a VMC-cube. Longitude is East longitude as defined above. (right) East longitude running from 0˚ to 360˚.</span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>It also follows that the <strong>Local Solar Time increases</strong> in the direction of <strong>decreasing East longitude</strong>.
The <strong>zonal wind</strong> moves the clouds in the direction of <strong>increasing LST</strong> and <strong>decreasing East longitude</strong>.</p>
<p>LST is calculated from the difference in longitude of a pixel on the Venus disk and the longitude of the <strong>Sub Solar Point</strong>. I verify that for the LST values reported in the VeRa <code class="file docutils literal notranslate"><span class="pre">.TXT</span></code> files, this gives the correct results. For example for the file <code class="file docutils literal notranslate"><span class="pre">Orb0260_EGR/V32ICL1L04_AEX_070060729_60.TXT</span></code> the <strong>Sub-Solar Longitude (lowest sample)</strong> is 178˚.51 and the longitude of the VeRa-sounded location lowest sample) is 244˚.58. The difference is 66˚.07, which corresponds to 6h x 90˚ / 66˚.07 = 4.40467h. As the longitude of the VeRa-location is larger than that of the sub-solar point, and from the conclusion that LST increases in the direction of decreasing longitude, it means that the VeRa-sounded location is more towards the morning limb, before noon: 12h - 4.40467h = 7.6h. The reported LST in the <code class="file docutils literal notranslate"><span class="pre">.TXT</span></code> file is 7.61h at 1bar, which is slightly becasue it is not corresponding to the lowest sample.</p>
</section>
<section id="references">
<span id="id4"></span><h3>References<a class="headerlink" href="#references" title="Link to this heading"></a></h3>
<p id="akiba2021"><strong>Akiba, M.</strong> <em>et al.</em>, 2021. Thermal Tides in the Upper Cloud Layer of  Venus as Deduced From the Emission Angle Dependence of the Brightness Temperature by Akatsuki/LIR. JRG Planets, 126, e2020JE006808, 140-158. <a class="reference external" href="https://doi.org/10.1029/2020JE006808">DOI 10.1029/2020JE006808</a>.</p>
<p id="archinal2018"><strong>Archinal, B.A.</strong> et al. 2018. Report of the IAU Working Group on CartographicCoordinates and Rotational Elements: 2015. Celest Mech Dyn Astr. 130, 22 - 68.
<a class="reference external" href="https://astropedia.astrogeology.usgs.gov/download/Docs/WGCCRE/WGCCRE2015reprint.pdf">DOI 10.1007/s10569-017-9805-5 (pdf)</a>.</p>
<p id="bevington2003"><strong>P.R. Bevington and D.K. Robinson</strong> 2003. Data Reduction and Error Analysis for the Physical Sciences. Third Edition, McGraw Hill Higher Education.</p>
<p id="crisp1986"><strong>Crisp, D.</strong> 1986. Radiative forcing of the Venus Mesosphere. I. Solar fluxes and heating rates. Icarus 67, 484 - 514. <a class="reference external" href="https://doi.org/10.1016/0019-1035(86)90126-0">DOI 10.1016/0019-1035(86)90126-0</a>.</p>
<p id="crisp1989"><strong>Crisp, D.</strong> 1989. Radiative forcing of the Venus Mesosphere. II. Thermal fluxes, cooling rates and radiative equilibrium temperatures. Icarus 77, 391 - 413. <a class="reference external" href="https://doi.org/10.1016/0019-1035(89)90096-1">DOI doi.org/10.1016/0019-1035(89)90096-1</a>.</p>
<p id="khatuntsev2013"><strong>Khatuntsev, I.V.</strong> <em>et al.</em>, 2013. Cloud level winds from Venus Express Monitoring Camera imaging. Icarus 226, 140-158. <a class="reference external" href="http://dx.doi.org/10.1016/j.icarus.2013.05.018">DOI 10.1016/j.icarus.2013.05.018</a>.</p>
<p id="lee2012"><strong>Lee, Y.J.</strong> <em>et al.</em>, 2012. Vertical structure of the Venus cloud top from the VeRa and VIRTIS observations onboard Venus Express.
Icarus 271, 599 - 609. <a class="reference external" href="https://doi.org/10.1016/j.icarus.2011.07.001">doi.org/10.1016/j.icarus.2011.07.001</a>.</p>
<p id="lee2015a"><strong>Lee, Y.J.</strong> <em>et al.</em>, 2015. Long-term variations of the UV contrast on Venus observed by the Venus Monitoring Camera on board Venus Express. Icarus 253, 1-15. <a class="reference external" href="http://dx.doi.org/10.1016/j.icarus.2015.02.015">DOI 10.1016/j.icarus.2015.02.015</a>.</p>
<p id="lee2015b"><strong>Lee, Y.J.</strong> <em>et al.</em>, 2015. The radiative forcing variability caused by the changes of the upper cloud vertical structure in the Venus mesosphere.
PSS 113-114, 298-308. <a class="reference external" href="https://doi.org/10.1016/j.pss.2014.12.006">DOI 10.1016/j.pss.2014.12.006</a>.</p>
<p id="markiewicz2007"><strong>Markiewicz, W.J.</strong> <em>et al.</em>, 2007. Venus Monitoring Camera for Venus Express. Planetary Space Science 55, 1701-1711. <a class="reference external" href="https://doi.org/10.1016/j.pss.2007.01.004">DOI 10.1016/j.pss.2007.01.004</a>.</p>
<p id="marcq2019"><strong>Marcq, R.</strong> <em>et al.</em>, 2019. Discovery of cloud top ozone on Venus. Icarus 319, 419-498, <a class="reference external" href="https://doi.org/10.1016/j.icarus.2018.10.006">DOI 10.1016/j.icarus.2018.10.006</a>.</p>
<p id="marcq2020"><strong>Marcq, R.</strong> <em>et al.</em>, 2020. Climatology of SO2 and UV absorber at Venus’ cloud top from SPICAV-UV T nadir dataset. Icarus 355, 133368, <a class="reference external" href="https://doi.org/10.1016/j.icarus.2019.07.002">DOI 10.1016/j.icarus.2019.07.002</a>.</p>
<p id="seiff1980"><strong>Seiff, Y.J.</strong> <em>et al.</em>, 1980. Measurements of Thermal Structure and Thermal Contrasts in the Atmosphere of Venus and Related Dynamical Observations: Results From the Four Pioneer Venus Probes. JGR 85, 7903-7933. <a class="reference external" href="https://doi.org/10.1029/JA085iA13p07903">DOI 10.1029/JA085iA13p07903</a>.</p>
<p id="shalygina2015"><strong>Shalygina, Y.J.</strong> <em>et al.</em>, 2015. Optical properties of the Venus upper clouds from the data obtained
by Venus Monitoring Camera on-board the Venus Express. Planetary Space Science 113-114, 135-158. <a class="reference external" href="https://doi.org/10.1016/j.pss.2014.11.012">DOI 10.1016/j.pss.2014.11.012</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Venus Research Workbook at ReadTheDocs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="veratools.html" class="btn btn-neutral float-right" title="VeRaTools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .
      <span class="lastupdated">Last updated on Nov 16, 2024, 11:05:07 PM.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>